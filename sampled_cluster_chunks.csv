chunk_id,chunk_seq_id,doc_id,chunk_text,chunk_embedding_vec,cluster
25979,115,2233.0,"```

### EDICT Image Editing Pipeline

This pipeline implements the text-guided image editing approach from the paper [EDICT: Exact Diffusion Inversion via Coupled Transformations](https://arxiv.org/abs/2211.12446). You have to pass:
- (`PIL`) `image` you want to edit.
- `base_prompt`: the text prompt describing the current image (before editing).
- `target_prompt`: the text prompt describing with the edits.

```python
from diffusers import DiffusionPipeline, DDIMScheduler
from transformers import CLIPTextModel
import torch, PIL, requests
from io import BytesIO
from IPython.display import display

def center_crop_and_resize(im):

    width, height = im.size
    d = min(width, height)
    left = (width - d) / 2
    upper = (height - d) / 2
    right = (width + d) / 2
    lower = (height + d) / 2

    return im.crop((left, upper, right, lower)).resize((512, 512))

torch_dtype = torch.float16
device = torch.device('cuda' if torch.cuda.is_available() else 'cpu')","[-2.76674218e-02 -1.79400258e-02  1.26469685e-02 -1.55712273e-02
  3.29994522e-02  1.42318429e-02 -2.19289921e-02  1.52346408e-02
 -1.97902285e-02  6.11519143e-02  1.04140593e-02 -9.17914137e-02
  3.76534723e-02 -1.48197112e-03 -2.04272158e-02  1.30304936e-02
 -3.49007994e-02  2.33733710e-02 -5.05523123e-02  1.33362403e-02
  6.69183359e-02 -1.30264871e-02  2.43099523e-03 -4.80170585e-02
  4.30588685e-02  2.83357222e-04 -1.75836496e-02 -1.89106390e-02
 -4.26359437e-02 -2.11514667e-01  3.69660519e-02 -2.90582143e-02
  3.59696969e-02 -2.77653243e-02 -1.18292468e-02 -1.63673013e-02
 -3.77539508e-02  2.37351730e-02 -2.22820658e-02  2.21331716e-02
  2.57045031e-02  9.56188794e-03 -5.49096800e-02 -2.66895089e-02
 -4.64412607e-02 -6.46191984e-02 -4.38092723e-02 -3.58059555e-02
  3.14992145e-02 -3.02806087e-02  4.87539312e-03 -2.71865795e-03
  2.87578925e-02  2.81504616e-02  2.23835348e-03  1.83050465e-02
  8.33420828e-02  4.38702554e-02  9.21514332e-02  1.26434797e-02
  2.56845653e-02  4.83778790e-02 -2.07046166e-01  1.28882408e-01
  1.52934482e-02 -5.99900680e-03 -5.20807598e-03 -7.64296427e-02
  2.28453949e-02  3.29186209e-02 -6.69948384e-02  3.36076133e-02
  2.39951424e-02  3.77851278e-02 -2.35898304e-04 -7.35539496e-02
 -2.91207451e-02 -3.75206470e-02 -1.37575921e-02  2.33779871e-03
  2.49631179e-04  2.11698981e-03 -4.04353030e-02 -2.98692705e-03
 -4.07079570e-02 -3.84248160e-02  1.82494521e-02 -2.63855141e-02
  2.73681302e-02  8.22390523e-03 -4.19309810e-02 -7.87796453e-02
 -2.87300851e-02  2.64514554e-02 -6.76071271e-02  4.69517632e-04
  7.55861923e-02 -2.51936577e-02 -4.80111130e-02  2.18343332e-01
 -4.05333824e-02  7.92170223e-03  6.34693308e-03  1.56219518e-02
  2.57160645e-02 -1.59474835e-02 -1.05263162e-02 -1.45294713e-02
 -7.35757081e-03 -5.92629542e-04 -5.45140123e-03 -1.75123680e-02
  5.60801513e-02 -1.23573029e-02  4.28919643e-02 -9.03799850e-03
 -2.66429328e-04  1.20561132e-02 -2.46522631e-02  1.09500373e-02
 -1.16777848e-02  1.26696788e-02 -1.00725172e-02  1.20160086e-02
  2.11385600e-02 -1.67492125e-02  5.80138341e-02  1.11920059e-01
  2.72964295e-02  3.37938368e-02  7.58674890e-02 -7.27789383e-03
 -4.68036439e-03  5.66681474e-03 -2.48848107e-02  7.81150833e-02
  9.38684400e-03 -3.38834263e-02  1.88362580e-02 -2.80919354e-02
 -3.87600111e-03 -8.24617520e-02 -3.21606472e-02 -6.16276041e-02
 -6.78143511e-03  1.47898480e-01 -4.63307202e-02  8.07955191e-02
 -6.13873675e-02 -7.36802444e-02 -3.29514593e-02  2.04879362e-02
 -3.41375284e-02  2.80421432e-02  2.59967353e-02  6.08637892e-02
  2.75520459e-02  6.46228716e-02 -1.07773608e-02  4.18258756e-02
 -1.52290650e-02 -6.40428364e-02 -6.44688234e-02  1.20773800e-01
  4.08645347e-02 -7.77771994e-02 -5.28638959e-02 -3.21708471e-02
 -4.68799658e-03  5.54623455e-03 -1.47231603e-02  3.57062928e-03
 -3.53675336e-02  1.79183595e-02  3.62442583e-02  6.46137968e-02
 -5.26131392e-02 -1.42519893e-02  1.46582313e-02 -1.56740360e-02
  7.06859380e-02 -1.70197506e-02  2.75659654e-02  2.76102498e-02
  1.23658394e-02 -6.91440776e-02 -8.35665781e-03 -5.37908860e-02
  4.12958227e-02  6.71996623e-02 -3.11111435e-02  6.45383298e-02
 -2.45459192e-02 -3.58121209e-02 -4.99367677e-02 -5.04002236e-02
 -5.91397844e-03 -4.72367965e-02 -5.59818037e-02 -2.52635404e-02
  1.80278085e-02  5.95161952e-02 -3.01901549e-02 -2.00132951e-02
 -2.73554884e-02  1.77832004e-02 -1.09013338e-02 -1.66719109e-02
  3.76028307e-02  2.19706390e-02 -4.14964259e-02 -3.30759883e-02
  8.72011334e-02 -3.58051062e-02 -4.97937687e-02 -1.71754975e-02
  1.70295704e-02  2.50261910e-02  3.42861451e-02  2.57856455e-02
  3.41378227e-02 -3.56665216e-02 -4.51043099e-02 -2.80771911e-01
  1.91278532e-02  5.26523851e-02 -2.04134043e-02  5.13329320e-02
 -4.68453951e-02  3.10065392e-02 -3.32368575e-02  2.69609429e-02
  6.28182814e-02  7.12543577e-02 -3.94897945e-02  1.74733363e-02
  1.38077745e-02 -2.17683823e-03  2.13007405e-02  2.05117855e-02
  1.09375571e-03 -1.52860917e-02 -1.29667772e-02 -4.74628247e-03
  1.73692554e-02 -1.21859759e-02 -6.29842952e-02  5.56048304e-02
 -2.52123252e-02  2.03793138e-01  5.27596809e-02  2.50780322e-02
 -1.12206722e-02  3.59024219e-02  2.20660903e-02 -2.72223651e-02
 -1.30350083e-01  3.40122767e-02  6.94446042e-02  3.76106054e-02
  1.22254519e-02 -1.08846147e-02 -2.15613358e-02  4.61398438e-03
  1.08993035e-02 -1.28390053e-02 -1.22282811e-01 -2.80105253e-03
  9.02571995e-03 -3.85359973e-02  1.31422197e-02 -3.90450358e-02
  2.25380212e-02  3.17854658e-02 -3.17208767e-02  1.39288856e-02
  2.06656624e-02 -2.42978074e-02 -4.59430702e-02 -7.05190897e-02
  4.32505980e-02 -6.06569136e-03  5.33926580e-03 -2.56043039e-02
 -6.06380142e-02  1.68123432e-02 -5.21980561e-02  2.80076638e-02
  2.17971765e-03 -1.48554109e-02 -3.50355245e-02  4.68082651e-02
 -2.88164206e-02  7.13771069e-03  5.21222726e-02 -5.67573728e-03
  4.55525815e-02  3.42696235e-02  5.28118797e-02  2.54463758e-02
  4.20044065e-02  7.35132303e-03 -3.09732035e-02  3.11632343e-02
  8.41502566e-03  4.00797203e-02  9.50902924e-02  3.14082131e-02
 -1.84368398e-02  5.19008115e-02 -3.48430946e-02  2.75977794e-02
 -3.17449644e-02 -2.16787010e-02  9.92352609e-03 -4.75388020e-02
  1.94752794e-02  1.86968278e-02 -1.39883906e-02 -2.97277898e-01
  4.56312485e-02  2.55983267e-02  1.71108488e-02  1.17900744e-02
  4.49494980e-02  2.75380015e-02  4.87209558e-02 -7.52317235e-02
 -1.39634209e-02 -9.88469645e-02  9.46809817e-03  7.30384886e-02
  2.10919809e-02 -2.25451756e-02  6.11465285e-03  5.77035658e-02
 -6.24278709e-02  3.86898480e-02 -7.73323402e-02 -1.24070663e-02
  2.77372859e-02  1.90068036e-01 -2.84468457e-02 -8.10964964e-03
 -2.61400826e-03 -9.67755623e-04 -2.71936897e-02  3.09070554e-02
  2.56555583e-02  2.24584471e-02  4.97671068e-02  5.09809330e-02
 -3.27275395e-02  7.09095448e-02  7.67664835e-02 -6.14301525e-02
  5.88577949e-02  9.60360188e-03 -1.77465938e-02 -3.13531831e-02
  1.75408181e-02 -2.90578380e-02 -2.51223296e-02  7.06932470e-02
 -2.95129162e-03  7.85980839e-03  1.20875984e-03 -3.67969275e-03
  2.53409259e-02 -2.01327670e-02  5.62720709e-02 -1.94034223e-02
  2.09888350e-03  4.34966609e-02  1.59429591e-02 -4.28919978e-02
 -2.05378104e-02 -3.74744013e-02  6.45935349e-03  4.94983643e-02
 -9.39239338e-02  1.96895245e-02  1.57563780e-02  6.25817897e-03]",53
583,6,58.0,"```

This however can make it difficult to build applications on top of `diffusers` as you will always have to pass the token around. A potential way to solve this issue is by downloading the weights to a local path `""./stable-diffusion-v1-5""`:

```
git lfs install
git clone https://huggingface.co/runwayml/stable-diffusion-v1-5
```

and simply passing the local path to `from_pretrained`:

```python
from diffusers import StableDiffusionPipeline

pipe = StableDiffusionPipeline.from_pretrained(""./stable-diffusion-v1-5"")
```

### Text-to-Image with default PLMS scheduler

```python
# make sure you're logged in with `huggingface-cli login`
from diffusers import StableDiffusionPipeline

pipe = StableDiffusionPipeline.from_pretrained(""runwayml/stable-diffusion-v1-5"")
pipe = pipe.to(""cuda"")

prompt = ""a photo of an astronaut riding a horse on mars""
image = pipe(prompt).images[0]

image.save(""astronaut_rides_horse.png"")","[-3.32958139e-02 -6.03378192e-02  3.61143686e-02 -4.13287943e-03
 -1.36091691e-02 -2.04244209e-03  1.21335555e-02 -7.99984788e-04
 -7.56959990e-03  1.24147879e-02 -8.78512673e-03 -8.60302150e-02
  4.39169817e-02  2.58505363e-02  2.73834299e-02  1.04217734e-02
 -2.87090298e-02 -2.19629286e-03 -3.72364372e-02  3.09342681e-03
  1.33757228e-02 -1.46204401e-02  1.14257745e-02 -6.90269545e-02
  4.32805764e-03  3.08691952e-02 -4.45684269e-02 -1.22113223e-03
 -1.10764923e-02 -2.25285709e-01 -1.40009532e-02 -9.95815098e-02
  3.01894154e-02 -1.94760114e-02  6.26354245e-03 -2.44893390e-03
 -3.19733061e-02  2.51786299e-02 -2.47925036e-02  4.14035544e-02
  2.10299361e-02 -1.36747034e-02  5.63971885e-03 -3.07010990e-02
 -1.92080680e-02 -6.48438483e-02 -6.40561208e-02 -2.82634553e-02
  6.12987652e-02 -1.30393999e-02  2.56722700e-02 -5.31944558e-02
  8.07956792e-03  1.34912422e-02 -1.21679315e-02  3.77777219e-02
  6.38367534e-02  3.61356959e-02  3.36813927e-02  2.60222275e-02
  1.05189905e-02  4.35310006e-02 -1.86961532e-01  9.30335522e-02
  3.48310545e-02 -2.81260768e-03 -3.85142304e-02 -5.36802113e-02
  1.77048538e-02  6.09200820e-02 -9.02898423e-03  4.14054692e-02
 -5.18679665e-03  5.83321825e-02  4.03580964e-02 -4.54474501e-02
  3.94690037e-03 -2.27979943e-02 -3.97222023e-03  3.11657600e-02
  2.45358497e-02  1.21632684e-03 -2.87749749e-02 -7.60310050e-03
 -2.49529630e-02  1.23628797e-02  1.80191491e-02 -7.18613416e-02
  3.74325812e-02  7.96701002e-04 -8.93875435e-02 -9.04865712e-02
  2.20056763e-03  7.95658231e-02 -7.42880106e-02 -7.30037270e-03
  6.70598149e-02  3.03982999e-02 -6.12416081e-02  2.29564443e-01
 -5.11736125e-02  3.85441668e-02  9.96061880e-03  1.79503188e-02
  4.58693504e-02 -2.58693956e-02  1.75965838e-02 -1.08313560e-02
  4.93760826e-03  1.20348530e-02  2.08209734e-02 -2.12381613e-02
  3.67838182e-02 -5.41558722e-04  4.42956388e-03  1.70352757e-02
  9.94019769e-03  1.65433194e-02 -4.76589873e-02  1.74962021e-02
 -4.38736100e-03  1.07925776e-02  4.61244695e-02  4.57810711e-05
  3.60033684e-03  4.95419418e-03  4.29666899e-02  8.93093050e-02
 -8.24697223e-03  2.89869029e-02  7.01668262e-02 -1.17199318e-02
 -4.60554548e-02 -1.95246153e-02 -2.68070381e-02  4.52945940e-02
  7.02333078e-03 -3.03800963e-02 -8.62496253e-03 -2.55874638e-02
 -2.97883786e-02 -1.04646623e-01 -2.36928966e-02 -8.28863755e-02
 -1.12651736e-02  1.19381554e-01 -3.22733633e-02  5.11634424e-02
 -6.37311081e-04 -2.74192654e-02 -5.44724241e-02  6.64497400e-03
 -2.67542154e-02 -8.36198311e-03  2.05207840e-02  4.35417667e-02
  3.70743796e-02  9.87365544e-02 -3.24382074e-02  1.51078785e-02
 -8.08756426e-03 -6.93751350e-02 -6.08464777e-02  1.12216011e-01
  2.30704304e-02 -4.33784947e-02  4.28800564e-03 -4.24241386e-02
 -4.08795103e-02 -3.02830674e-02  1.68655086e-02 -8.55004508e-03
 -4.71297242e-02  1.88248828e-02  5.76613285e-02  1.58909243e-02
 -6.53893724e-02  3.36424867e-03  3.80972549e-02  2.15241667e-02
  3.89239676e-02 -4.05165367e-02 -1.51637075e-02  7.78375519e-03
  3.78253870e-02 -4.65564355e-02 -4.12632301e-02 -5.59813939e-02
  3.92024517e-02  4.59839515e-02 -7.26619270e-04  4.13550809e-02
 -3.05011049e-02 -5.77231087e-02 -4.98813912e-02 -2.15953104e-02
 -1.70990974e-02 -3.24202999e-02  1.78549755e-02 -4.91770031e-03
  6.65109605e-02  2.57641654e-02  6.82875048e-03  2.09856424e-02
 -3.90766039e-02  1.69624649e-02 -2.27435585e-02 -1.25543075e-02
  5.11715338e-02  2.70336792e-02 -6.21103756e-02  1.13375904e-02
  7.35353678e-02 -4.69862521e-02 -6.93969950e-02  2.45455876e-02
 -5.50867384e-03  5.53515553e-03  6.61809370e-02  1.03357248e-02
  1.27897365e-02 -3.36265080e-02 -6.59402087e-02 -2.89135396e-01
  2.68231835e-02  5.85443303e-02  2.88464176e-03  5.23126051e-02
 -3.56362313e-02  5.73223047e-02  1.23645561e-02  2.85618901e-02
  9.19875354e-02  1.15783952e-01 -3.31329182e-02  1.45366928e-02
  3.15864570e-03 -1.51194250e-02  2.66354252e-02  4.12120670e-03
  1.76281873e-02  1.23709617e-02 -2.88592521e-02 -1.37826689e-02
 -3.74610908e-02 -1.35734621e-02 -8.85971189e-02  4.50806841e-02
  1.90430740e-03  2.38794312e-01  5.33108711e-02  7.01753981e-03
 -1.28139043e-02  4.14066203e-02  2.71617267e-02 -2.34399140e-02
 -1.24361530e-01  2.77460590e-02  1.78726285e-03  6.16908353e-03
 -1.55733628e-02  4.27906364e-02  7.49799481e-04 -3.32056694e-02
  3.42392363e-02 -2.06906442e-03 -6.73181266e-02  1.53754372e-02
 -3.87447141e-02 -7.02679809e-03  1.21784173e-02 -3.18463445e-02
  4.82492242e-03  4.91904207e-02 -1.17743490e-02  2.86933295e-02
  1.53993182e-02  1.35791246e-02 -5.45919016e-02 -2.16954164e-02
  1.16870115e-02 -7.56935496e-03  3.75925750e-02 -1.38054201e-02
 -6.60822690e-02  2.41529979e-02 -1.16587346e-02  3.30017544e-02
 -2.72070784e-02  8.65845301e-04 -3.60296182e-02  5.04136309e-02
 -8.74564610e-03  1.74021292e-02  1.07831478e-01 -7.52530387e-03
  2.75711361e-02  7.01657981e-02  7.02911895e-03 -1.14189123e-03
  3.84680182e-02 -1.86837669e-02 -2.24884902e-03  3.49017866e-02
 -1.95634272e-02  2.57404279e-02  6.46590963e-02  2.88482476e-02
  4.84095979e-03  2.33686604e-02 -1.38814375e-02  4.17474434e-02
 -3.72313336e-02  6.50590518e-04  6.69642240e-02 -4.49846573e-02
  1.24748051e-02  5.39508052e-02  1.04360199e-02 -3.04007977e-01
  4.74949256e-02  2.92663779e-02  1.33019658e-02  1.01504335e-02
  4.27016579e-02  6.27627447e-02  4.34090346e-02 -1.04275130e-01
 -4.21069786e-02 -5.12766354e-02  1.64440311e-02  3.59734334e-02
  2.51282509e-02  3.55967204e-03  5.16738892e-02  1.57166068e-02
 -5.39806783e-02  1.62149426e-02 -6.20137379e-02 -3.63263264e-02
  2.72391364e-02  2.06624910e-01 -4.72152121e-02 -5.51792467e-03
  1.30878417e-02 -2.62756422e-02  3.78153920e-02  7.59761781e-02
  2.80723628e-02  2.27892818e-03 -5.81652531e-03  6.84199706e-02
 -4.55194004e-02  3.10091805e-02  2.35320069e-02 -2.02642661e-02
  2.09636148e-02  2.44743959e-03 -4.74220440e-02 -1.19229546e-02
  1.73164755e-02 -1.46403061e-02 -6.12126701e-02  3.64787839e-02
 -4.06991430e-02 -9.68870986e-03 -1.96253303e-02 -1.33464215e-04
 -3.60472710e-03 -3.72133590e-02 -1.12409256e-02 -5.97170778e-02
 -1.48429479e-02  5.50947376e-02  3.45510915e-02 -2.69741789e-02
 -2.28091627e-02 -3.67575511e-02 -2.04507564e-03  2.65564900e-02
 -9.17602032e-02 -2.05842336e-03 -9.76541545e-03  2.89235897e-02]",53
10049,1,852.0,"```
import gradio as gr
import torch
from diffusers import StableDiffusionPipeline
from PIL import Image
import os

auth_token = os.getenv(""auth_token"")
model_id = ""CompVis/stable-diffusion-v1-4""
device = ""cpu""
pipe = StableDiffusionPipeline.from_pretrained(
    model_id, use_auth_token=auth_token, revision=""fp16"", torch_dtype=torch.float16
)
pipe = pipe.to(device)


def infer(prompt, samples, steps, scale, seed):
    generator = torch.Generator(device=device).manual_seed(seed)
    images_list = pipe(
        [prompt] * samples,
        num_inference_steps=steps,
        guidance_scale=scale,
        generator=generator,
    )
    images = []
    safe_image = Image.open(r""unsafe.png"")
    for i, image in enumerate(images_list[""sample""]):
        if images_list[""nsfw_content_detected""][i]:
            images.append(safe_image)
        else:
            images.append(image)
    return images


block = gr.Blocks()","[-4.60890681e-02  4.87227862e-06  2.05606297e-02 -1.71972420e-02
  3.88165787e-02  2.49728449e-02  1.99750755e-02 -6.79465802e-03
 -2.37587765e-02  1.69828366e-02  2.63216021e-03 -1.06699631e-01
  2.14633644e-02 -4.48405696e-03 -5.63185848e-02  2.16795467e-02
 -2.07037274e-02  1.76159721e-02 -4.24860716e-02 -2.11964622e-02
  3.43915261e-02 -9.42638051e-03 -5.48744621e-03 -7.35827610e-02
  2.40881182e-02  4.02923673e-03 -5.20476326e-03  1.57376562e-04
 -4.11478989e-03 -2.06335530e-01  1.92022603e-02 -7.33926296e-02
  4.22730204e-03 -3.97455767e-02 -3.18328035e-03 -9.98940412e-03
 -2.66954601e-02  4.61198688e-02 -4.39121686e-02  6.18877187e-02
  1.87929568e-03 -2.17117053e-02 -3.72915678e-02 -4.31488827e-02
 -2.06433125e-02 -5.05228341e-02 -4.35731709e-02 -4.03053463e-02
  4.94553074e-02 -2.77137421e-02  3.32858693e-03 -1.80588514e-02
  1.17820408e-02  1.17324283e-02 -2.03757528e-02 -7.24470802e-03
  6.30055368e-02  3.13130841e-02  4.26717773e-02  3.38481851e-02
  5.86937089e-03  5.65080009e-02 -2.11053893e-01  8.81488696e-02
  2.50445213e-02  2.53401939e-02 -4.65048142e-02 -4.85923588e-02
  1.21784713e-02  3.92421708e-02 -2.14004666e-02  4.03478928e-02
  1.93569604e-02  4.05738391e-02 -1.32565328e-03 -4.22470793e-02
 -1.03882048e-03 -3.60512994e-02 -3.37814167e-02  4.30925228e-02
 -2.86297128e-02  4.79334220e-03 -1.15349088e-02 -3.09979860e-02
 -1.51382005e-02 -1.40167056e-02  5.33376150e-02 -5.99819236e-02
  4.16202471e-02 -2.62449728e-03 -6.52795285e-02 -1.68742053e-02
 -1.56646222e-02  9.26596522e-02 -5.17008714e-02 -2.84121837e-02
  5.59735969e-02 -5.11306478e-03 -4.12850305e-02  1.97619826e-01
 -5.40726222e-02  3.29569937e-03  2.85859592e-02  3.21704671e-02
  2.08062157e-02 -1.25758369e-02 -2.99030691e-02 -4.08598445e-02
 -4.57844175e-02 -1.56946350e-02  2.12483499e-02 -3.96932550e-02
  7.67736584e-02 -3.16797942e-02  1.22321788e-02 -5.15122339e-03
 -5.32272691e-03 -2.36441176e-02 -2.44344100e-02  3.06439716e-02
  1.01805264e-02 -5.80454664e-03  4.37781364e-02 -1.09520592e-02
  2.14095358e-02 -1.46868816e-02  3.27403694e-02  1.30409256e-01
  2.28190832e-02  7.99232051e-02  3.27260233e-02 -1.19964825e-02
 -2.33542155e-02  1.15940692e-02  1.42248282e-02  5.35392538e-02
  4.31886166e-02 -1.62141081e-02  1.18502025e-02 -1.49803972e-02
 -2.78352089e-02 -8.38440359e-02 -2.20601517e-03 -8.94086957e-02
  9.58371256e-03  1.11041836e-01 -5.43044209e-02  1.12680644e-01
 -1.39882294e-02 -4.88056205e-02 -3.12139164e-03  2.27470938e-02
 -1.36009613e-02 -2.60746498e-02  4.76016700e-02  4.86681461e-02
  1.36191014e-03  9.63256136e-02 -3.80832776e-02  3.91737334e-02
 -5.15257046e-02 -7.73357823e-02 -4.10124585e-02  1.05834194e-01
  1.50020802e-02 -5.90842292e-02  1.19936121e-04 -1.86728388e-02
 -3.65274213e-02 -3.07536442e-02  5.38878180e-02  1.41935358e-02
 -3.82206179e-02 -2.21147612e-02  2.08279211e-02  1.52269388e-02
 -4.67774235e-02 -3.59699083e-03  2.49132179e-02  3.97207551e-02
  5.87118492e-02 -1.24335922e-02 -2.53738351e-02  1.99170895e-02
  4.35619541e-02 -6.08365312e-02 -2.44912915e-02 -4.41690944e-02
  3.72657808e-03  7.31350854e-02 -6.13598637e-02  2.13667285e-02
 -3.75892371e-02 -4.02966104e-02 -1.75374057e-02 -1.57998465e-02
 -3.06089204e-02 -2.04990152e-02 -2.08460074e-02 -2.61466578e-02
  6.20611459e-02  3.98929752e-02 -1.22658769e-02 -1.28954491e-02
 -6.37332276e-02  3.73366550e-02 -4.27058339e-02 -9.11024772e-03
  5.41001260e-02 -4.34431061e-03 -5.61182834e-02 -1.07476301e-02
  5.42696454e-02 -1.42074386e-02 -4.97334488e-02 -1.25340791e-03
 -7.93956406e-03  5.98985562e-03 -4.49186144e-03  4.30682003e-02
  4.10746299e-02 -4.49481606e-02 -7.97715113e-02 -2.67843664e-01
  3.71509269e-02  4.30670455e-02  2.39335522e-02  4.25690934e-02
 -4.73407060e-02  6.28368556e-02 -1.88172590e-02  2.41374108e-03
  8.21892023e-02  1.08295664e-01 -6.61235815e-03  2.62119938e-02
  1.04569411e-02 -3.30581553e-02  1.21414233e-02  1.57935880e-02
  9.99301951e-03 -6.39790064e-03  2.19910555e-02  3.65280895e-03
 -2.59759799e-02 -3.39471642e-03 -8.84371549e-02  5.74039258e-02
 -3.91807109e-02  2.21005604e-01  2.70414818e-02  3.26468842e-03
 -9.03331209e-04  3.98666523e-02  2.07818784e-02 -4.34793793e-02
 -9.83429775e-02  2.55531352e-02  5.17784730e-02  1.63636077e-02
  4.97493185e-02  4.32086550e-02 -7.63374241e-03 -3.48854028e-02
  5.79692125e-02  1.36368610e-02 -9.18359309e-02 -1.90966334e-02
 -2.84501072e-03 -1.63708702e-02  4.23654169e-02 -1.62248500e-02
  1.35929845e-02  6.80002570e-02 -1.21416515e-02  5.73984571e-02
  1.39363334e-02 -9.21951234e-03 -4.39530686e-02 -6.06679730e-02
  2.82042809e-02 -3.00724450e-02  3.65230180e-02 -1.36513114e-02
 -3.88676375e-02  4.66134399e-03 -3.82903889e-02  4.39581834e-02
 -3.06444839e-02 -1.03099532e-02 -4.68890332e-02  4.00251895e-02
 -2.77246181e-02  2.10036412e-02  7.87216052e-02 -4.61690943e-04
  2.68816110e-02  5.09318933e-02  4.00893651e-02  1.27898185e-02
  1.67838689e-02 -3.48921306e-02 -1.90914907e-02  3.18825059e-02
 -1.02922013e-02  2.52589360e-02  7.45315850e-02  4.50633503e-02
  1.03537505e-02  6.00159215e-03 -2.06480715e-02  4.72050980e-02
 -1.57721248e-02 -1.31077282e-02  3.35181542e-02 -4.60422933e-02
  1.06083490e-02  3.40416320e-02 -1.28764855e-02 -3.18415761e-01
  3.21925581e-02 -2.84981285e-03  5.38828485e-02 -1.78253055e-02
  7.33602501e-04  6.34115860e-02  4.02293652e-02 -9.60774273e-02
 -2.91013271e-02 -7.84218684e-02  2.56681517e-02  5.62564172e-02
  3.69972214e-02 -3.43116396e-03  2.88565420e-02  5.77136502e-02
 -6.61016926e-02  4.28164192e-02 -4.52846661e-02  1.91001117e-03
  3.70559059e-02  2.12271303e-01 -5.94243221e-02  1.01755764e-02
  9.39607248e-03  2.86133718e-02  5.29825548e-03  2.74091158e-02
  2.70509608e-02  3.00808102e-02  6.73095090e-03  4.50748466e-02
 -4.16517369e-02  6.65553808e-02  6.96529076e-02 -6.70490414e-02
  4.36606109e-02  1.87097099e-02 -6.44610599e-02 -4.64920141e-02
  1.32641625e-02 -1.65110044e-02 -1.36855207e-02  5.57447299e-02
 -4.79760282e-02 -3.43783647e-02 -3.10198031e-02  1.34278983e-02
  1.85977668e-02 -2.05870699e-02  1.37542095e-02 -9.56255011e-03
 -5.40828891e-03  5.64371496e-02  3.23156379e-02 -4.36250307e-02
  1.77371614e-02 -5.58580123e-02 -3.68931741e-02  4.84382398e-02
 -7.04895929e-02  1.62900146e-02  8.14074837e-03 -7.31373299e-03]",53
14104,19,1159.0,"```

or the more aggressive layer based CPU offloading.

```py
pipe = DiffusionPipeline.from_pretrained(""DeepFloyd/IF-I-XL-v1.0"", variant=""fp16"", torch_dtype=torch.float16)
pipe.enable_sequential_cpu_offload()
```

Additionally, T5 can be loaded in 8bit precision

```py
from transformers import T5EncoderModel

text_encoder = T5EncoderModel.from_pretrained(
    ""DeepFloyd/IF-I-XL-v1.0"", subfolder=""text_encoder"", device_map=""auto"", load_in_8bit=True, variant=""8bit""
)

from diffusers import DiffusionPipeline

pipe = DiffusionPipeline.from_pretrained(
    ""DeepFloyd/IF-I-XL-v1.0"",
    text_encoder=text_encoder,  # pass the previously instantiated 8bit text encoder
    unet=None,
    device_map=""auto"",
)

prompt_embeds, negative_embeds = pipe.encode_prompt(""<prompt>"")","[-0.0745549  -0.03425873  0.0446815  -0.01879128  0.00531333  0.01250079
  0.00746967  0.00673198  0.01360574 -0.0185908   0.01238087 -0.06324115
  0.0420532   0.01226404 -0.05176741  0.02279181  0.00163676  0.018777
 -0.04590014 -0.03605514  0.05273684 -0.04667228 -0.01588934 -0.03934519
  0.03207551 -0.00553076 -0.04643457 -0.00338915 -0.03158432 -0.24267796
  0.00508771 -0.07063035  0.02597293 -0.05707698  0.02343237 -0.03199614
 -0.05339022  0.0270221  -0.00908863  0.05038165  0.01441039  0.00879891
 -0.02952682 -0.05981299 -0.02136058 -0.04608346 -0.0581111  -0.00368687
  0.02656804 -0.01900405  0.0121293   0.00662831  0.01305348  0.01175995
  0.00226707  0.00830002  0.06096524  0.04999694  0.05873578  0.02508136
  0.00708003  0.03976296 -0.17370637  0.08471933  0.0325112   0.03646036
 -0.05154791 -0.05061197  0.00977733  0.07309824 -0.0754049   0.04668074
  0.01625483  0.07350796  0.02562043 -0.01044935 -0.01899405 -0.00256551
  0.02018321  0.03120015  0.02205439 -0.02440991 -0.02306903 -0.00902805
 -0.01926084 -0.04871682  0.0309772  -0.04057458  0.01546195 -0.02326086
 -0.07249914  0.01318426 -0.00826103  0.04412477 -0.04446684 -0.03533041
  0.05747706 -0.00179057 -0.03779014  0.21458158 -0.05184164 -0.01885536
 -0.01122422  0.02780364  0.03300118 -0.02861152 -0.02663235 -0.00770081
 -0.02746069 -0.01532104  0.02160952 -0.05166656  0.02498212 -0.03243983
  0.04371709  0.0127596   0.0088778  -0.01871736 -0.06713965  0.01863147
 -0.00482171 -0.01129248  0.02824613 -0.02459689 -0.00337779 -0.00613699
  0.05196512  0.10402677 -0.00437151  0.03458297  0.03439947 -0.00604808
 -0.02040187  0.00580455  0.0009299   0.06553644  0.01703678 -0.01636841
  0.0388467  -0.04435644 -0.04457355 -0.07674203 -0.0112694  -0.08709301
 -0.0036942   0.12498172 -0.02343911  0.04259544 -0.01432663 -0.0332575
 -0.02636925  0.00526087 -0.0193301  -0.02183928  0.02158078  0.05111605
 -0.0016739   0.085537   -0.04715065 -0.0010235  -0.04881752 -0.08187079
 -0.05233699  0.10452589 -0.00772324 -0.08372946 -0.02229926 -0.05317823
  0.00151831 -0.03471475  0.02787529 -0.03335844 -0.06131531  0.01272415
  0.03573154 -0.01829495 -0.04985577 -0.03374121  0.01148697  0.01507993
  0.0421066  -0.00180219 -0.00054786  0.01778794  0.0327902  -0.06795479
 -0.01847727 -0.02996873  0.01961055  0.05925799 -0.0677122   0.04956583
 -0.03061706 -0.04050625 -0.00793937  0.0004723  -0.03181311  0.01187766
 -0.00443044 -0.08000222  0.03923468  0.05451831 -0.02783932  0.01345812
 -0.0118414   0.03691416 -0.00228814 -0.0160673   0.07708542  0.02349261
 -0.00754241 -0.03893175  0.06311619  0.01092326 -0.04157889 -0.01013264
  0.0131203   0.01675306  0.0323875   0.03507952 -0.01943884 -0.04335606
 -0.05953443 -0.23511194  0.03749216  0.02186645 -0.04890356  0.05494858
 -0.02116621  0.03268069 -0.0247515   0.00181753  0.06042572  0.10875564
 -0.02990523  0.0043524  -0.00169598 -0.02856945  0.06432252  0.01799229
  0.0094853  -0.02837048  0.0226924   0.01571776 -0.01562744 -0.03442795
 -0.0912884   0.04582696  0.01360348  0.23727655 -0.02192119  0.10284423
  0.00748099  0.04225473  0.04071647  0.00873615 -0.12020197  0.05440713
  0.02278469  0.07812735  0.02175985  0.0602118   0.02702216 -0.03566271
  0.0347164   0.00567579 -0.13571383 -0.02102285 -0.02381462 -0.01262464
 -0.00060421 -0.06463062  0.01310557  0.04870064 -0.02239745  0.04991039
  0.0338074   0.03974536 -0.01605996 -0.08933653  0.03593589 -0.06711016
  0.0139087   0.01019267 -0.02959521 -0.03690781 -0.0549545   0.00768349
 -0.00638554 -0.01754433 -0.03326502  0.05984966  0.01703309  0.04313872
  0.08549538 -0.05469834  0.06319848  0.02942842  0.03046508  0.04627917
  0.02549463 -0.02663045 -0.01688155  0.05751871 -0.01952944  0.03495928
  0.05602894  0.01867554  0.00272452  0.03102232  0.01369022  0.03916828
 -0.00491975 -0.04840291  0.01698326 -0.02308412  0.0156664   0.05421541
 -0.02451141 -0.28541234  0.04000875  0.05345418  0.02114644 -0.00751558
  0.00497777  0.04148627  0.0377722  -0.07831629  0.01159268 -0.09262571
  0.02586645  0.05045649  0.03515636 -0.0093863   0.01149397  0.08152232
 -0.06330319  0.02121495 -0.0370729  -0.01402207  0.01344181  0.20529059
 -0.04632933  0.02906748  0.01663341 -0.02221187  0.02685436  0.06136819
 -0.02413804  0.04232887 -0.01197108  0.06933711 -0.04381267  0.01925565
  0.04559908 -0.02947033  0.02772002  0.05040226  0.01804224 -0.02939428
  0.01368736 -0.03859471 -0.05175962  0.05249328  0.00568745 -0.02728147
 -0.04656448  0.00806288  0.02362659  0.00976979  0.00622915 -0.00731385
  0.04476466  0.06385383  0.03117094 -0.02675377 -0.01218404 -0.03562961
 -0.04577845  0.06986941 -0.10900969  0.0003394   0.04492196 -0.00443524]",53
16962,4,1434.0,"```

### Local pipeline

To load a diffusion pipeline locally, use [`git-lfs`](https://git-lfs.github.com/) to manually download the checkpoint (in this case, [`runwayml/stable-diffusion-v1-5`](https://huggingface.co/runwayml/stable-diffusion-v1-5)) to your local disk. This creates a local folder, `./stable-diffusion-v1-5`, on your disk:

```bash
git-lfs install
git clone https://huggingface.co/runwayml/stable-diffusion-v1-5
```

Then pass the local path to [`~DiffusionPipeline.from_pretrained`]:

```python
from diffusers import DiffusionPipeline

repo_id = ""./stable-diffusion-v1-5""
stable_diffusion = DiffusionPipeline.from_pretrained(repo_id, use_safetensors=True)","[-4.08932157e-02 -5.81380650e-02  4.45410311e-02  7.61077041e-03
  2.40759756e-02  7.26867607e-03 -3.11895628e-02 -1.93050466e-02
 -1.29577303e-02 -3.51509042e-02 -2.55110096e-02 -9.41139907e-02
  4.30017076e-02 -1.73551124e-02  1.63159464e-02  2.57752966e-02
 -4.19387855e-02  3.11770644e-02 -2.41272841e-02 -2.82662809e-02
 -3.84484231e-03 -1.11451615e-02 -7.84879830e-03 -5.96064851e-02
  3.06059681e-02  2.80114468e-02 -2.60093957e-02 -5.59979538e-03
 -2.72900406e-02 -2.27558762e-01  3.54388752e-03 -8.39818940e-02
 -1.88294071e-04  8.55168793e-03  3.12827341e-03 -3.74904892e-04
  1.56483203e-02  2.81110667e-02 -3.28657106e-02  6.19308539e-02
  2.59811282e-02  7.85761047e-03 -3.72347608e-02 -2.10203398e-02
 -4.34366427e-03 -7.76689500e-02 -3.14454660e-02 -5.67083918e-02
  7.83935115e-02 -3.40392329e-02  3.33606638e-02 -4.80106957e-02
 -1.75721981e-02 -1.59606431e-02 -4.49607559e-02  4.93985452e-02
  8.14247206e-02  5.04782610e-02  3.58520634e-02  1.57372374e-02
  4.22153436e-02  1.76879968e-02 -1.92049563e-01  6.85883388e-02
  4.33669202e-02  5.26774265e-02 -3.40450220e-02 -4.20556180e-02
  6.33528233e-02  5.95769621e-02 -6.42597079e-02  2.69437078e-02
  5.96268522e-03  6.71735033e-02  2.48515867e-02 -6.78120106e-02
  1.51556768e-02 -1.01103652e-02  1.73185989e-02  2.99543440e-02
  2.08575781e-02 -6.10560703e-04 -3.54394242e-02 -2.19465848e-02
 -5.73529974e-02 -1.59040913e-02  2.36044135e-02 -2.59760898e-02
  2.61253659e-02  2.62233205e-02 -6.50646687e-02 -2.50400975e-02
  2.61169784e-02  5.24324328e-02 -7.59326890e-02 -3.63978632e-02
  6.46527335e-02 -9.27428424e-04  2.29621083e-02  2.27269575e-01
 -4.74153198e-02  4.17493172e-02  1.66657139e-02  2.64900401e-02
  2.15287227e-02 -6.58306759e-03  1.84009504e-02 -1.31714633e-02
 -1.35332458e-02  1.72609985e-02  1.42228641e-02 -4.85093556e-02
  2.81354003e-02 -2.92496402e-02  3.73836681e-02  2.22065509e-03
 -1.08667463e-02  1.75743736e-02 -6.08473197e-02  1.30170183e-02
 -5.93652297e-03  2.63810698e-02  7.15352297e-02 -1.03922272e-02
  4.28280607e-02 -4.85539407e-04  3.55875008e-02  7.33566731e-02
  3.50413807e-02  3.63785960e-02  2.52547748e-02  1.01855258e-03
 -4.77813445e-02  1.47187166e-05 -2.61838641e-02  2.21746210e-02
  4.34657792e-03 -3.02618556e-02 -4.79522953e-03 -5.55998571e-02
 -7.39162788e-03 -6.90515935e-02 -1.91011690e-02 -1.08247161e-01
 -3.31826247e-02  1.21907465e-01 -6.59610797e-03  7.71392733e-02
 -4.78554145e-02 -6.17536455e-02 -2.76209358e-02  3.29241762e-03
 -2.35917587e-02 -1.86041892e-02  2.79864706e-02  2.38950104e-02
  4.10557650e-02  1.07378438e-01 -3.72849815e-02  3.59752178e-02
 -2.45584920e-02 -9.76137072e-02 -5.26757352e-02  1.46322578e-01
  2.45495159e-02 -6.37965053e-02 -1.97883695e-02 -2.29362771e-02
 -5.22530056e-04 -2.68071573e-02  3.68576013e-02 -1.25213182e-02
 -2.66745593e-02  1.14594726e-02  4.33693975e-02  7.43405835e-05
 -6.25170991e-02  2.94382079e-03  3.98756750e-02  2.12893561e-02
  2.14779675e-02 -2.30064727e-02 -2.82084960e-02  2.16109734e-02
  2.79259570e-02 -6.08634092e-02 -2.13948991e-02 -4.57061641e-02
 -1.22683747e-02  5.32243773e-02 -1.69258211e-02  4.47005667e-02
 -3.95677574e-02 -8.74210522e-02 -5.56864310e-03 -4.65021357e-02
 -1.31716812e-02 -2.08933260e-02  1.23005603e-02 -3.13556418e-02
  5.28973565e-02  3.83951776e-02 -3.18847075e-02  1.99220981e-02
 -6.52998984e-02  2.18248982e-02 -2.39540078e-02 -2.49410551e-02
  4.17336151e-02  1.29549550e-02 -2.96242740e-02  3.01622264e-02
  6.16453923e-02  1.14092343e-02 -4.41493392e-02  3.45246564e-03
  2.22463049e-02 -1.37490705e-02  4.77880463e-02  3.73084657e-02
  3.45397592e-02 -1.81708355e-02 -5.69597818e-02 -2.42219537e-01
  3.25269625e-02  5.00870831e-02  2.24552806e-02  7.49480873e-02
 -3.78085710e-02  5.26702777e-02 -1.87049955e-02  9.04878322e-03
  9.54572260e-02  1.31429419e-01 -4.19729836e-02  1.39340414e-02
  4.97955792e-02 -1.03314817e-02  4.07982953e-02  3.20094600e-02
  1.42583214e-02 -1.98949073e-02 -1.85594801e-02 -1.32662859e-02
 -4.93878648e-02 -6.00980483e-02 -5.84990382e-02  6.51182234e-02
 -5.45195211e-03  2.25607440e-01 -1.50519103e-04  3.96573916e-02
 -1.63003150e-02  5.09228706e-02  1.06056826e-02 -2.06191633e-02
 -1.45308778e-01  1.10778939e-02  1.94565263e-02  4.02798168e-02
 -2.33202875e-02  2.12003849e-02 -1.70240027e-03 -4.13692892e-02
  5.26076704e-02  2.19886680e-03 -7.28818253e-02 -2.20548678e-02
 -3.27634960e-02 -1.60533991e-02  5.14884479e-02 -4.35078107e-02
 -3.58227454e-02  3.61851305e-02 -3.81514146e-05  4.82040085e-02
  4.68840171e-03  1.07910493e-02 -3.84044461e-02 -2.03116965e-02
  1.52563863e-02 -4.06455994e-02 -5.89880999e-03 -5.71995694e-03
 -3.26265804e-02  1.37401391e-02 -4.87961993e-02  5.32444231e-02
 -9.52516031e-03 -5.23373811e-03 -3.75576690e-02  6.36493415e-02
 -2.64740176e-02  4.45028469e-02  5.98787442e-02 -2.83139236e-02
  3.76722999e-02  4.86303121e-02  3.80162857e-02  2.17135833e-03
  1.42475367e-02 -4.72868532e-02 -2.34582480e-02  3.57832871e-02
 -6.19803518e-02  5.71939088e-02  7.60678202e-02 -8.70723743e-03
  4.09778655e-02  3.77519839e-02 -1.28521807e-02  4.28802781e-02
 -2.21202262e-02  1.38531374e-02  2.43332349e-02 -4.65431623e-02
 -1.68784391e-02  3.56973223e-02 -7.13743689e-03 -2.84823120e-01
  4.95727994e-02  1.45860072e-02  1.26672145e-02  1.17366984e-02
  1.19966008e-02  5.50961755e-02  4.82848622e-02 -3.82446200e-02
 -1.38927288e-02 -4.53423634e-02  2.22114567e-02  2.68140081e-02
  3.68982032e-02  3.21392156e-02  2.19506398e-02  4.06104550e-02
 -2.96716914e-02  1.80595070e-02 -7.23627433e-02 -4.05632406e-02
  3.23825255e-02  1.81010172e-01 -3.35810222e-02  6.50394009e-03
  2.08904538e-02 -1.33218728e-02  2.28256490e-02  3.96708623e-02
 -5.77693060e-03 -3.58507875e-03  4.12825271e-02  3.92583087e-02
 -5.91164120e-02  5.37402071e-02  4.38044816e-02 -5.02449162e-02
  7.10232481e-02  4.69620712e-02 -7.09423125e-02 -2.64717042e-02
  1.37714641e-02 -3.46248560e-02 -1.23148793e-02  4.43949439e-02
 -9.50567424e-02 -1.47983953e-02 -8.11452791e-02 -1.29002181e-03
 -8.41348246e-03 -1.72378216e-02  1.02130612e-02 -1.60034038e-02
 -1.35688977e-02  5.20503260e-02  6.28751889e-02  9.35645960e-03
 -8.26444197e-03 -7.76077136e-02 -1.86047889e-02  1.42338350e-02
 -8.16769078e-02  2.74804123e-02 -6.61483873e-03  3.14096473e-02]",53
25948,84,2233.0,"```
pip install k-diffusion
```

You can use the community pipeline as follows:

```python
from diffusers import DiffusionPipeline

pipe = DiffusionPipeline.from_pretrained(""CompVis/stable-diffusion-v1-4"", custom_pipeline=""sd_text2img_k_diffusion"")
pipe = pipe.to(""cuda"")

prompt = ""an astronaut riding a horse on mars""
pipe.set_scheduler(""sample_heun"")
generator = torch.Generator(device=""cuda"").manual_seed(seed)
image = pipe(prompt, generator=generator, num_inference_steps=20).images[0]

image.save(""./astronaut_heun_k_diffusion.png"")","[-1.89937390e-02 -2.32877694e-02  2.88730245e-02 -2.73292442e-03
  3.26546356e-02  6.61804294e-03 -1.65419243e-02 -1.79005656e-02
 -3.54547724e-02  1.34437215e-02  1.52811070e-03 -9.15337726e-02
  5.47598824e-02 -8.20894167e-03  8.26302357e-03  2.16626097e-02
 -1.13120265e-02  3.48841399e-02 -3.13983895e-02 -1.08597865e-02
  3.48634832e-03 -1.08776679e-02  6.26296271e-03 -5.45692928e-02
  1.74774714e-02 -8.38677399e-03 -2.27403175e-02 -3.50788422e-02
 -2.23276000e-02 -1.98343486e-01  1.36931380e-03 -7.35152438e-02
  4.65007946e-02 -2.03739796e-02 -3.55325406e-03  2.00955640e-03
 -2.13831589e-02  1.74037740e-02 -5.91390952e-02  7.22872913e-02
  7.08823185e-03 -9.89281293e-03 -6.60451408e-03 -9.72883962e-03
 -1.47362687e-02 -4.44292761e-02 -5.64352758e-02 -5.83509542e-02
  5.76291494e-02 -3.64143811e-02  3.84950489e-02 -4.60751839e-02
 -3.75255942e-03  2.39208825e-02  5.94210671e-03  1.64860487e-02
  5.68804704e-02  3.12997028e-02  6.48354217e-02  1.87016875e-02
  1.34567858e-03  5.20885028e-02 -2.21610233e-01  9.02635008e-02
  1.82154048e-02  2.22104322e-02 -2.16690302e-02 -5.53240702e-02
  3.84624489e-02  2.49937810e-02 -3.44796143e-02  6.05638064e-02
  1.70796663e-02  6.26924559e-02  1.33888470e-02 -5.98990060e-02
 -8.83619767e-03 -1.11512756e-02 -1.96053218e-02  2.50830725e-02
 -1.09149907e-02  2.73975963e-03 -2.30340809e-02 -2.23188959e-02
 -2.49696542e-02 -5.08291135e-03  3.43384258e-02 -6.14616312e-02
  1.91781744e-02  2.63631158e-02 -5.65590039e-02 -3.59038077e-02
  5.59411850e-03  3.37974355e-02 -7.22824931e-02 -1.64120905e-02
  5.34350239e-02 -1.82963256e-02 -2.23877970e-02  2.18981251e-01
 -4.54057492e-02  1.55416876e-02  7.43026007e-03  2.68256068e-02
  7.09526334e-03 -4.94508743e-02 -6.63709780e-03 -2.11662613e-02
  1.12847071e-02 -4.56619170e-03 -1.19122618e-03 -2.28727199e-02
  4.20226082e-02 -2.45064404e-02  2.46911887e-02 -1.22655537e-02
  3.99290957e-03  3.66223091e-03 -1.96355283e-02  2.91795004e-02
  1.73410531e-02 -1.60379969e-02  5.53897023e-02 -2.37806144e-05
  6.14134036e-02 -9.58703645e-03  4.38328385e-02  8.14316645e-02
 -3.54402466e-03  2.33344603e-02  4.79406603e-02  1.06536848e-02
 -2.80478764e-02  4.53466130e-03 -3.42592336e-02  1.84287149e-02
  1.54236024e-02 -1.49209378e-02 -1.06712617e-03 -2.39013769e-02
 -2.03807186e-02 -6.82014897e-02 -1.50388815e-02 -9.04721394e-02
 -2.92579383e-02  1.12243935e-01  7.07883993e-03  6.56568110e-02
 -2.63186321e-02 -2.42203511e-02 -4.14967239e-02  1.07440026e-02
 -3.14648822e-02 -9.27191880e-03  4.43086438e-02  4.89222957e-03
  4.29831780e-02  9.52034295e-02 -5.85161410e-02  5.73126711e-02
 -3.20143998e-02 -9.57353339e-02 -5.60025610e-02  1.41374618e-01
  1.58178844e-02 -7.80666247e-02 -1.60268582e-02 -2.37316452e-02
  2.25432850e-02 -1.02380011e-02  5.32688461e-02  2.70260889e-02
 -5.23340739e-02  4.60429005e-02  4.79365736e-02 -3.28112487e-03
 -6.87495172e-02 -4.54879040e-03  4.22199890e-02 -8.55238270e-03
  5.37625737e-02  2.39704940e-02 -5.31024970e-02  3.51679213e-02
  3.03574577e-02 -8.04490894e-02 -3.17581370e-02 -1.69854593e-02
  1.75117739e-02  5.92967905e-02 -8.82832706e-03  4.99965400e-02
 -2.55238861e-02 -6.74925148e-02 -1.78316534e-02 -1.66177247e-02
 -1.64874960e-02 -4.25871685e-02 -1.02914767e-02 -5.97080663e-02
  2.93279476e-02  1.23370541e-02 -4.81470264e-02 -6.52186805e-04
 -6.11091927e-02  3.00147980e-02 -2.04207487e-02  1.19851669e-03
  5.31670637e-02 -8.54279567e-03 -4.47411872e-02 -1.95571482e-02
  7.81706572e-02 -5.25841396e-03 -4.82666641e-02  3.04469652e-02
  1.60120763e-02  4.73708147e-03  5.38373068e-02  3.54303122e-02
  5.68655878e-02 -3.36632840e-02 -6.62601143e-02 -2.81223804e-01
  1.55497435e-02  5.53858243e-02  4.84647602e-02  7.27183148e-02
 -5.03260605e-02  7.56140128e-02 -1.21799260e-02  2.58653183e-02
  9.82377529e-02  1.39540374e-01 -4.82792668e-02  2.74221860e-02
  9.00724623e-03 -4.46921121e-03  3.00138537e-02  2.18770001e-02
  2.85291318e-02  2.62513217e-02 -7.16302078e-04  3.15822358e-03
 -2.81613562e-02 -9.77648888e-03 -7.67069981e-02  2.99771950e-02
 -2.44001597e-02  2.21547455e-01  4.05668728e-02  2.47863140e-02
 -1.32760890e-02  4.54721898e-02  3.08544617e-02 -2.56238356e-02
 -1.48800507e-01  2.67289840e-02  2.86105480e-02  5.04479371e-02
  1.17487479e-02 -1.02831240e-04 -2.04396117e-02 -3.08784246e-02
  5.44663966e-02 -1.43493703e-02 -8.21425840e-02 -1.23799476e-03
 -2.78908629e-02 -4.28463798e-03  5.61971515e-02 -4.39682566e-02
 -1.24809025e-02  5.88824041e-02 -8.77938326e-03  3.21123153e-02
 -5.16972644e-03  1.95563305e-02 -4.83299904e-02 -5.78845292e-02
  2.21091695e-02 -3.24761979e-02  1.03448583e-02 -3.86856752e-03
 -4.63637486e-02  1.40692070e-02 -5.10898232e-02  4.28816751e-02
 -1.44835776e-02  5.84181910e-03 -1.50420144e-02  5.54763675e-02
 -2.96027400e-02  1.99550670e-02  1.05167329e-01 -3.49339359e-02
  4.22631092e-02  5.26504032e-02  4.74141128e-02  2.52976976e-02
  8.88264738e-03 -3.12372902e-03 -2.78829876e-02  5.20264693e-02
 -4.17090431e-02  4.37712222e-02  6.95506781e-02  1.70820970e-02
  2.51909755e-02  2.73401141e-02 -1.88679546e-02  3.23983952e-02
 -3.89872603e-02 -1.71994399e-02  3.77693847e-02 -3.49113494e-02
 -4.64486470e-03  2.22078227e-02  1.50998319e-02 -2.99801499e-01
  3.20121013e-02  1.47165172e-02  3.27181369e-02 -5.14781801e-04
  1.98618099e-02  5.35785481e-02  2.90043000e-02 -6.14282824e-02
 -4.00554128e-02 -6.82105049e-02  3.70253287e-02  2.59926934e-02
  2.57861838e-02 -6.81697205e-03  2.78971810e-02  5.31458557e-02
 -5.69076128e-02 -2.52392190e-03 -7.58513510e-02 -2.27609789e-03
  1.85645968e-02  1.83860734e-01 -3.09533104e-02 -1.10972840e-02
 -1.32008474e-02 -2.76266783e-03  1.01212207e-02  1.69245079e-02
 -1.42498538e-02  1.51040955e-02  2.37087868e-02  5.67159057e-02
 -4.76862229e-02  3.76504138e-02  7.77183473e-02 -5.33057526e-02
  2.06339583e-02  6.60540955e-03 -3.34482491e-02 -2.08195504e-02
  2.38649361e-02 -2.73910556e-02 -3.86506356e-02  4.43450660e-02
 -3.26615535e-02 -2.93819439e-02 -9.20369998e-02 -4.01730509e-03
 -1.26466323e-02 -3.00292242e-02  1.02936486e-02 -4.14834581e-02
 -2.22805119e-03  5.37064485e-02  7.25210160e-02 -2.03539915e-02
 -1.25154955e-02 -1.50863733e-02 -3.99216935e-02  2.51060054e-02
 -1.01019666e-01  3.56067047e-02  4.93418425e-03 -1.96024403e-03]",53
6710,16,531.0,"# speed up diffusion process with faster scheduler and memory optimization
pipe.scheduler = UniPCMultistepScheduler.from_config(pipe.scheduler.config)
# remove following line if xformers is not installed or when using Torch 2.0.
pipe.enable_xformers_memory_efficient_attention()
# memory optimization.
pipe.enable_model_cpu_offload()

control_image = load_image(""./conditioning_image_1.png"")
prompt = ""pale golden rod circle with old lace background""

# generate image
generator = torch.manual_seed(0)
image = pipe(
    prompt, num_inference_steps=20, generator=generator, image=control_image
).images[0]
image.save(""./output.png"")","[-6.17685206e-02  1.73184753e-03  5.18948995e-02  1.13247326e-02
  1.73560381e-02  3.05521693e-02 -2.82373540e-02 -1.15082720e-02
 -1.84894167e-02  4.86387387e-02  2.83222948e-03 -6.66174963e-02
  4.10967469e-02  1.26003232e-02 -1.88274737e-02  4.67059650e-02
 -1.81798637e-02  1.92859825e-02 -5.77379540e-02 -4.15608399e-02
  4.31342795e-02 -7.13425055e-02 -2.89997924e-03 -7.08188415e-02
  3.46129537e-02  3.49929254e-03 -4.00984511e-02 -1.53249521e-02
 -2.33591404e-02 -2.40923181e-01  2.38103997e-02 -3.85460630e-02
  2.68833786e-02 -5.16303517e-02 -2.10299119e-02 -4.02384698e-02
 -3.36581655e-02  6.25954568e-02 -7.33686090e-02  5.00690565e-02
  4.61115735e-03  4.12291549e-02 -5.31154610e-02 -1.87466033e-02
 -4.43710759e-02 -5.92313260e-02 -1.27322283e-02 -3.42652425e-02
  3.46638449e-02 -4.45236750e-02  1.83620825e-02 -1.05839064e-02
  3.41773815e-02 -1.56361554e-02  1.54240075e-02  2.45619453e-02
  6.74584210e-02  1.46119464e-02  5.49463667e-02  9.27297398e-03
 -2.66104238e-03  2.82049887e-02 -1.97988138e-01  9.97304395e-02
  3.35885286e-02  2.05260552e-02 -2.91660763e-02 -5.52453287e-02
  1.60013493e-02  4.85802107e-02 -2.66060904e-02  6.11121990e-02
  4.47991043e-02  6.93776831e-02  2.02967622e-03 -4.35099378e-02
 -2.87019834e-02 -5.56825399e-02 -8.42288695e-03  4.38577645e-02
 -1.27289342e-04  9.59527306e-03 -4.64470498e-02 -4.15494032e-02
 -6.54009869e-03 -1.39769325e-02  1.82514321e-02 -4.65371460e-02
  4.55847085e-02  7.18741957e-03 -2.69552507e-02 -2.46836841e-02
 -2.98561100e-02  3.25657278e-02 -4.82370295e-02 -1.73506513e-02
  5.63011467e-02  2.74783447e-02 -4.73746136e-02  2.29715481e-01
 -3.89742553e-02 -9.15850420e-03  2.71902997e-02 -1.95240602e-03
  2.66100131e-02 -3.28277238e-02 -1.70956552e-02 -1.57692712e-02
 -5.87219335e-02 -2.04063719e-03  2.32114345e-02 -4.55735624e-02
  4.75577451e-02 -1.07762162e-02  2.07657833e-02  5.86184533e-03
  1.49992555e-02  3.36504206e-02 -6.56121522e-02  4.41990569e-02
 -5.46436850e-03  8.19681864e-03  2.32881792e-02  1.70224663e-02
 -2.67862715e-03 -1.98096801e-02  2.59044804e-02  8.61458927e-02
 -2.77054706e-03  5.44463545e-02  3.21096107e-02 -6.18472137e-03
 -1.37370825e-02  4.24072379e-03 -1.35986507e-02  3.35802771e-02
  2.98122354e-02 -1.87730454e-02  1.00292731e-02 -4.88427021e-02
 -4.42286134e-02 -6.81240410e-02 -1.52824046e-02 -1.19960852e-01
  1.93079710e-02  1.41827255e-01 -3.22607090e-03  6.42072409e-02
 -3.67682129e-02 -4.02972400e-02 -2.51283776e-02  2.25103796e-02
 -3.00167035e-02 -6.21477887e-02  2.86544189e-02  2.34353058e-02
  1.86031554e-02  7.64670894e-02 -2.49689743e-02  4.20551375e-02
 -3.43867727e-02 -4.74403799e-02 -1.06161805e-02  9.40321982e-02
  2.75689177e-02 -8.57200101e-02 -2.81569250e-02 -3.51213552e-02
 -1.82239972e-02  1.73665234e-03 -1.08677791e-02  2.29144841e-02
 -6.29473329e-02 -5.19090006e-03  9.14048553e-02  1.04111070e-02
 -1.79425571e-02 -4.76211011e-02  1.17872166e-03  6.91031385e-03
  1.00501850e-01 -3.47837014e-03 -2.50361720e-03  2.53664535e-02
  3.24688181e-02 -9.28858742e-02 -9.81028285e-03 -2.83558369e-02
  4.15512407e-03  6.88523427e-02 -6.12889603e-02  2.29257774e-02
 -3.49646732e-02 -4.18184511e-02 -1.91265512e-02  8.13921914e-04
 -2.28682049e-02 -2.35079601e-03 -3.53619978e-02 -3.17151062e-02
  3.39267850e-02  3.54797170e-02 -2.86554676e-02  1.56275760e-02
 -1.81771535e-02  3.83019932e-02 -3.16293649e-02 -1.19909747e-02
  7.60706514e-02  3.30009498e-02 -6.17396459e-02 -4.06164974e-02
  7.18084127e-02  5.45767415e-03 -4.79223393e-02  1.83786023e-02
  8.54637101e-03  3.43410559e-02  3.40864025e-02  4.44328673e-02
  3.87557000e-02 -2.48712711e-02 -7.49342963e-02 -2.48790160e-01
  2.19804533e-02  2.25611161e-02  1.37740774e-02  6.21987917e-02
 -4.75182012e-02  3.27459872e-02 -2.96506751e-02  4.86352816e-02
  7.91041553e-02  8.22224021e-02 -3.70033830e-02  3.36446315e-02
 -2.17878204e-02 -2.32533161e-02  1.75029617e-02  6.32368308e-03
  4.32978421e-02 -1.06658600e-03 -1.41103370e-02  1.75586678e-02
  2.68326793e-03  5.03359847e-02 -9.96785983e-02  3.33097205e-02
 -5.82897253e-02  2.08497658e-01 -2.14419235e-03  1.02078198e-02
 -2.64275074e-02  4.85089459e-02  3.13256085e-02 -4.02329378e-02
 -1.07338883e-01  1.71789099e-02  3.48267145e-02  5.33332564e-02
  2.84871762e-03  3.29679660e-02  1.20268553e-03 -3.36361416e-02
  5.35962246e-02 -8.29605106e-03 -8.69163647e-02 -2.87665967e-02
 -1.68134850e-02 -9.49810166e-03  4.34349515e-02 -3.88267562e-02
 -1.11865979e-02  5.14682233e-02 -3.51328440e-02  5.30083477e-02
  1.72085464e-02  1.89688578e-02 -8.04348662e-02 -9.57419574e-02
  3.45865190e-02 -6.31968081e-02  3.73001732e-02  1.62806851e-03
 -4.44961153e-02  2.07754802e-02 -3.81611213e-02  4.14230600e-02
  1.49739929e-03 -6.92700362e-03 -3.76990587e-02  2.05151197e-02
 -1.93707773e-03  2.08347533e-02  5.53696975e-02 -2.56419694e-03
  8.09424743e-03  4.33966815e-02  2.89674737e-02  2.80596502e-03
 -1.74605343e-02 -3.10270898e-02 -5.65424282e-03  5.59207015e-02
 -5.24510182e-02  6.31960854e-02  4.84547876e-02  3.69317271e-02
  1.03287837e-02  3.25878784e-02  1.37447119e-02  3.51068974e-02
  1.53187532e-02 -4.96319830e-02  4.66882205e-03 -4.52380627e-02
  1.90460123e-02  3.16664614e-02 -6.40159240e-03 -2.95200884e-01
  3.78594957e-02  2.73893923e-02  1.76699180e-02 -4.60201828e-03
  6.92801550e-04  4.83157374e-02  3.52046974e-02 -1.71380881e-02
  1.56816803e-02 -9.56449434e-02  1.98223181e-02  3.88402641e-02
  6.44732490e-02 -1.11441538e-02  2.64626425e-02  6.09967560e-02
 -4.94463556e-02  1.30033838e-02 -6.13398664e-02 -1.11767510e-02
  1.80428028e-02  2.22619399e-01 -2.25977115e-02  1.50343496e-02
  2.45056003e-02 -1.31399771e-02  1.26265595e-02  4.77433018e-02
 -3.17095146e-02  3.42381150e-02  1.56771839e-02  6.98474571e-02
 -3.40453982e-02  5.47404848e-02  6.81551918e-02 -4.48723808e-02
  4.78715077e-02  2.66510136e-02 -2.78819501e-02 -2.96993945e-02
  1.88491493e-02 -1.23782046e-02 -1.75303128e-02  5.69994524e-02
 -6.66696280e-02 -3.85166258e-02 -3.12322229e-02  1.86886061e-02
  1.31996106e-02 -2.13539898e-02  1.94083937e-02 -2.63749771e-02
 -3.77291068e-03  3.89032476e-02  4.33296748e-02 -3.49999629e-02
 -2.10613701e-02 -2.24795956e-02 -3.98820043e-02  3.80246453e-02
 -8.05220604e-02  2.67463885e-02  3.99460271e-03  1.97960697e-02]",53
29774,3,2522.0,"```

<Tip>

You'll notice throughout the guide, we use [`~DiffusionPipeline.enable_model_cpu_offload`] and [`~DiffusionPipeline.enable_xformers_memory_efficient_attention`], to save memory and increase inference speed. If you're using PyTorch 2.0, it's not necessary to call [`~DiffusionPipeline.enable_xformers_memory_efficient_attention`] on your pipeline because it'll already be using PyTorch 2.0's native [scaled-dot product attention](../optimization/torch2.0#scaled-dot-product-attention).

</Tip>

2. Load the base and mask images:

```py
init_image = load_image(""https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/diffusers/inpaint.png"")
mask_image = load_image(""https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/diffusers/inpaint_mask.png"")","[-3.72564867e-02  5.87805826e-03  4.91004586e-02 -5.21381618e-03
  2.32024305e-02  1.91757232e-02  3.43852048e-03 -1.57741718e-02
 -1.86012313e-02  2.59217918e-02  1.32711614e-02 -9.01439935e-02
  4.09673229e-02  1.88194234e-02 -8.81796237e-03  3.78040187e-02
 -2.15566698e-02  5.01068495e-02 -3.88423689e-02 -3.31869572e-02
  1.70930978e-02 -5.59458025e-02  1.13282516e-03 -2.78021116e-02
  1.76046714e-02  1.64564163e-03 -3.58028710e-02 -8.42026062e-03
 -1.53090749e-02 -2.41702452e-01  3.78558710e-02 -6.30082414e-02
  1.91468894e-02 -2.06511226e-02 -3.51968743e-02 -2.36981418e-02
 -2.18644794e-02  3.80270816e-02 -2.84499731e-02  5.35303392e-02
 -2.26246379e-02  2.02667415e-02 -5.69918081e-02 -3.71248648e-02
 -2.49362495e-02 -4.89123985e-02 -1.89120919e-02 -2.77418904e-02
  1.62812565e-02 -3.71941552e-02 -8.08896776e-03 -2.06973534e-02
  1.05345501e-02 -9.72839165e-03  7.84462783e-03  2.61472147e-02
  5.00582680e-02  1.62892286e-02  7.54705742e-02  8.55764374e-03
  4.89173457e-03  9.11158975e-03 -1.96873039e-01  7.39331543e-02
  3.22696194e-02  2.72754133e-02 -2.92997807e-02 -7.25684091e-02
  1.33201890e-02  5.21881208e-02 -3.48614007e-02  3.69222872e-02
  1.75799597e-02  5.08689396e-02 -1.33112371e-02 -3.12994607e-02
 -2.75118966e-02 -3.56917754e-02  1.17162615e-02  3.12077217e-02
  1.27340201e-02 -1.74426865e-02 -5.38648292e-02 -5.05204163e-02
  1.22584309e-02 -9.98567976e-03  5.12746722e-03 -4.50332984e-02
  2.90695261e-02 -4.82083634e-02 -3.56012657e-02 -4.64039296e-02
 -3.30511332e-02  3.24330628e-02 -5.77692054e-02 -7.78729888e-03
  4.84305210e-02  3.13781016e-02 -5.07091805e-02  2.17389882e-01
 -2.20316611e-02 -2.71160863e-02 -3.30560915e-02  9.74083785e-03
  4.20693606e-02 -8.14663172e-02 -9.01217014e-03 -1.33199655e-02
 -5.88668995e-02  1.67099331e-02  2.33331323e-02 -4.52421494e-02
  3.46913375e-02  5.78297302e-04  3.90327461e-02 -1.16347009e-02
  2.42612120e-02  1.73712894e-02 -3.25807482e-02  2.00252682e-02
  1.16893053e-02 -1.71202712e-03  3.67620699e-02  2.39210650e-02
  1.55825764e-02 -1.01736207e-02  2.63470933e-02  1.02966771e-01
 -6.67994563e-03  4.96906005e-02  4.13489901e-02 -2.89986599e-02
 -3.67002711e-02  7.58709526e-03 -3.58484574e-02  1.95427220e-02
  4.38348576e-02  1.16190147e-02  1.43664693e-02 -4.16737273e-02
 -3.69015783e-02 -5.23721129e-02  1.24101329e-03 -7.07581341e-02
 -1.38696032e-02  1.47810355e-01 -3.27694863e-02  7.71183372e-02
 -4.45303544e-02 -2.88472846e-02 -6.53530937e-03  4.37639244e-02
 -2.47249734e-02 -1.78868379e-02  5.08996993e-02  3.26575600e-02
 -3.44385370e-03  7.47584030e-02 -6.17257766e-02  3.12647335e-02
 -3.47322859e-02 -6.66880757e-02 -4.81752418e-02  7.35678673e-02
 -1.24179926e-02 -4.91358005e-02 -3.37025747e-02 -5.92129193e-02
 -3.94657254e-02  1.27076032e-03  3.95074394e-03  6.86183339e-03
 -2.48368941e-02  2.50002295e-02  6.03939332e-02  1.64646581e-02
 -5.29750139e-02 -4.08764593e-02  1.44972922e-02  3.09971049e-02
  5.54092266e-02 -7.71789718e-03  2.15368555e-03  1.95175856e-02
  1.41308829e-02 -8.26148242e-02 -1.42078130e-02 -3.42678428e-02
  2.95922207e-03  5.34475856e-02 -4.47854139e-02  4.12316509e-02
 -2.56845132e-02 -3.83575596e-02 -2.02715471e-02  1.95150990e-02
 -5.22649009e-03  1.11789219e-02 -2.57752910e-02 -4.83407080e-02
  3.89697962e-02  2.58275643e-02 -5.05411997e-02  2.07915809e-02
 -2.22268701e-02  2.40177289e-02 -3.52049693e-02 -1.27314928e-03
  9.52521414e-02 -4.55051707e-03 -6.01281635e-02 -1.79257262e-02
  5.53888828e-02 -3.14565608e-03 -6.69070408e-02  3.44949737e-02
  2.73614805e-02  1.27044987e-04  1.49107128e-02  4.36395891e-02
  5.67408949e-02 -7.78385773e-02 -7.61678517e-02 -2.41590351e-01
  2.24493761e-02  2.50853244e-02 -6.29491988e-04  5.46431206e-02
 -9.09155756e-02  3.30677144e-02  1.94838941e-02  4.94452417e-02
  9.26207379e-02  8.37740302e-02 -1.83305666e-02  2.33732611e-02
  5.11400355e-03 -2.40907096e-03  3.17585282e-02  1.28430063e-02
  1.32360216e-02 -4.69269939e-02 -1.21441726e-02  2.01880876e-02
 -2.82858964e-03  2.42069480e-03 -6.61846474e-02  4.80830036e-02
 -5.50577007e-02  2.37072840e-01  1.06154187e-02 -9.33798123e-03
  1.61149781e-02  1.05402246e-02  5.82926832e-02 -4.36921939e-02
 -1.33280858e-01  2.84765642e-02  7.73450313e-03  3.11840493e-02
  1.86547311e-03  2.25560740e-02  1.71187185e-02 -2.18078271e-02
  5.98929971e-02  4.60762298e-03 -9.56152976e-02 -1.89213399e-02
  8.22843798e-03 -3.09081078e-02  4.58395109e-02 -5.31072915e-02
 -6.92938222e-03  5.78202866e-02 -2.46739835e-02  6.29845709e-02
  2.00768802e-02 -5.10205003e-03 -7.45304972e-02 -6.92079589e-02
  8.01451039e-03 -7.12134987e-02  4.59644347e-02  1.80173619e-03
 -4.72150408e-02  3.00439354e-02 -5.27101457e-02  1.39684733e-02
  3.48611851e-03 -2.87013855e-02 -4.96392883e-02  4.58911769e-02
  1.84650123e-02 -6.95877010e-04  8.73644948e-02 -1.60600971e-02
  4.24716249e-02  4.99403179e-02  4.19570208e-02  4.58992273e-02
 -3.59376473e-03 -4.20169048e-02 -5.38864871e-03  5.72136156e-02
 -1.15340808e-02  3.01494487e-02  8.58273953e-02  3.13884318e-02
  1.18309101e-02  3.17609012e-02  3.15745771e-02  4.75521199e-02
 -1.20357424e-02 -5.96691109e-02  4.60852720e-02 -5.00723757e-02
 -1.64606911e-03  4.52106372e-02 -1.76827163e-02 -3.02718818e-01
  5.62619716e-02  3.54634821e-02  1.97214112e-02 -1.36506781e-02
  2.50085425e-02  5.71282133e-02  4.02470864e-02 -3.98966186e-02
 -2.31313184e-02 -6.66706786e-02  4.07811292e-02  6.21692277e-02
  4.98213880e-02 -2.91577093e-02  4.73860502e-02  6.33447915e-02
 -5.82514890e-02  5.36207147e-02 -5.63994832e-02 -3.52188274e-02
  5.96440118e-03  2.09044009e-01 -1.69267263e-02  2.24196836e-02
  2.62131216e-04 -8.48153606e-03  1.11287285e-04  5.99410720e-02
  1.63832642e-02  3.79841924e-02  7.61049287e-03  4.65912819e-02
 -4.82988507e-02  5.76953031e-02  8.25506449e-02 -4.71436456e-02
  2.11488754e-02  6.50608167e-02 -3.02662048e-02  1.52278086e-02
  5.51696459e-04 -5.06463088e-02 -3.31893638e-02  4.35885862e-02
 -5.55937067e-02 -7.41023803e-03 -1.59808341e-02 -1.67606864e-02
  2.19292529e-02 -1.75508354e-02  3.34869768e-03 -3.17067280e-02
  9.43746231e-03  7.92141184e-02  1.88237075e-02 -1.70279015e-02
  6.74214028e-03 -2.06570998e-02 -1.36994235e-02  5.97279370e-02
 -7.98065215e-02 -4.56951885e-03  1.37885371e-02  2.97920350e-02]",53
496,18,49.0,"```

![](https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/diffusers/lcm/lcm_sdxl_t2iadapter.png)


## Inpainting

LCM-LoRA can be used for inpainting as well. 

```python
import torch
from diffusers import AutoPipelineForInpainting, LCMScheduler
from diffusers.utils import load_image, make_image_grid

pipe = AutoPipelineForInpainting.from_pretrained(
    ""runwayml/stable-diffusion-inpainting"",
    torch_dtype=torch.float16,
    variant=""fp16"",
).to(""cuda"")

# set scheduler
pipe.scheduler = LCMScheduler.from_config(pipe.scheduler.config)

# load LCM-LoRA
pipe.load_lora_weights(""latent-consistency/lcm-lora-sdv1-5"")

# load base and mask image
init_image = load_image(""https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/diffusers/inpaint.png"")
mask_image = load_image(""https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/diffusers/inpaint_mask.png"")","[-2.47548949e-02 -5.08194640e-02  2.24755984e-02 -5.20736678e-03
  1.48211401e-02  3.28159746e-04  1.12045361e-02 -2.77664810e-02
 -2.70663369e-02 -1.12990644e-02  2.00864058e-02 -1.15609080e-01
  3.70534956e-02  2.45029107e-02  9.44694318e-03  7.04675401e-03
 -2.76654083e-02  6.48531318e-02 -2.64972840e-02 -3.46480086e-02
  2.04109289e-02 -3.57813761e-02 -2.91325357e-02 -5.89833334e-02
  3.53002101e-02  1.72524694e-02 -3.92612591e-02  3.87742859e-03
  6.89709140e-03 -2.19207495e-01  1.06765619e-02 -3.89445201e-02
  3.71666960e-02 -4.96292971e-02  1.07821096e-02 -3.83768673e-03
 -5.09286337e-02  5.10788821e-02 -4.55608778e-02  1.01451585e-02
  2.23733205e-02 -1.60520934e-02 -6.21508472e-02 -7.52603263e-02
 -4.00753990e-02 -7.14841634e-02 -4.89644930e-02 -4.40674974e-03
  2.14905832e-02 -1.19795501e-02  1.61218047e-02 -6.16948716e-02
  1.05219977e-02  2.10675113e-02  8.18928238e-03  4.30133939e-02
  8.04497823e-02  2.48817801e-02  4.39678989e-02  4.58075590e-02
 -5.26295556e-03  4.04498167e-02 -1.75455317e-01  8.02524909e-02
  4.85883374e-03  3.25549692e-02 -4.20516841e-02 -5.64268939e-02
  3.50906178e-02  8.00697878e-02 -5.36703281e-02  3.70101035e-02
  5.10253534e-02  4.15799953e-02  5.09337522e-02 -3.58952507e-02
 -1.10781239e-02 -2.01782063e-02 -5.88025525e-02  3.55237015e-02
  1.34019284e-02 -3.34015861e-02  1.29958251e-02 -7.86581077e-03
  1.35339759e-02 -1.31930911e-03  1.13825435e-02 -6.40342310e-02
  6.08173423e-02  8.13156459e-03 -6.42734244e-02 -4.24645357e-02
 -5.24857976e-02  4.57778163e-02 -8.42103213e-02 -1.24334088e-02
  5.32912649e-02  4.03299965e-02 -1.94540173e-02  2.28869170e-01
 -3.60278264e-02 -1.19192498e-02  6.70035370e-03 -3.34115000e-03
  2.60869022e-02 -2.62514278e-02  4.72891051e-03 -3.31209414e-02
 -3.54433767e-02 -7.68427784e-03  7.51630822e-03  3.22016887e-03
  3.93670760e-02 -3.52278315e-02  1.92482527e-02 -1.38666043e-02
  4.02858444e-02  1.74239110e-02 -2.58640219e-02  4.10752781e-02
  7.31129851e-03  5.03663952e-03 -4.74626059e-03  3.86004453e-03
  3.84435281e-02 -3.97662073e-02  4.20553572e-02  8.03952366e-02
  2.75598727e-02  5.31196781e-02  3.33136842e-02 -4.44991514e-03
 -6.45598248e-02 -9.36160423e-03 -3.47044040e-03  5.14051057e-02
  4.64742891e-02 -2.62143314e-02  3.31768990e-02 -2.74522211e-02
 -1.81918722e-02 -7.72949085e-02 -4.95523727e-03 -8.35675225e-02
  1.24069015e-02  1.07046135e-01 -4.99349907e-02  7.85540566e-02
 -4.39937897e-02 -1.68826450e-02 -4.88645658e-02  1.44376429e-02
 -5.54033890e-02  4.96174721e-03  5.40413968e-02  2.92098466e-02
  4.54773046e-02  8.90540481e-02 -4.52647731e-02  3.96090560e-02
 -7.86915235e-03 -5.02982102e-02 -5.60836233e-02  1.27745017e-01
 -1.48501452e-02 -7.88329765e-02 -2.01692767e-02 -1.81029085e-02
 -2.24943571e-02 -8.91550072e-03  1.36081772e-02  2.85031255e-02
 -3.95407751e-02 -5.87571459e-03  6.97786957e-02  6.33497834e-02
 -8.26787204e-02  4.66898549e-03  3.80631052e-02  3.85192074e-02
  4.33645360e-02 -2.74151862e-02 -4.02206415e-03  4.29656990e-02
 -2.74013318e-02 -8.17208514e-02 -1.11432783e-02 -9.15413443e-03
 -1.04495212e-02  5.83386011e-02 -4.28217724e-02  2.89363656e-02
 -7.28049374e-04 -2.52757575e-02 -3.22086439e-02 -3.02190147e-02
 -3.89707536e-02 -3.72067206e-02  8.66855215e-03 -6.11241423e-02
  5.54327816e-02  4.28824946e-02 -9.14598163e-03  7.18966452e-03
 -8.41728598e-03  4.67367135e-02 -3.52874286e-02 -2.97030509e-02
  7.31409267e-02  4.86601628e-02 -8.50260109e-02  4.89940401e-03
  4.62080315e-02 -1.44769968e-02 -3.11716255e-02  3.63521613e-02
  1.13297170e-02  3.04886396e-03  3.02172340e-02  8.36011302e-03
  4.14340645e-02 -4.76797894e-02 -5.62263764e-02 -2.41353199e-01
  8.59732181e-02  4.45223227e-02  1.45272519e-02  2.56102234e-02
 -4.07588594e-02  3.01228222e-02  8.95329379e-03 -1.27336604e-03
  9.96690392e-02  8.09663609e-02  4.67827776e-03  2.63349768e-02
 -4.72848816e-03 -1.79397687e-02 -4.91116836e-04  1.14188334e-02
  2.05385834e-02 -5.73715661e-03 -2.72026099e-02 -2.00485485e-03
 -1.00998003e-02  8.64656363e-03 -4.71919067e-02  3.59160900e-02
 -1.54109178e-02  2.48384282e-01  9.29390080e-03 -3.16188224e-02
 -2.28196662e-02  2.37333868e-02  2.97586918e-02 -8.37117955e-02
 -1.08556047e-01  5.34795830e-03  2.37623621e-02  1.65948439e-02
 -1.94266457e-02  2.63233390e-02 -1.27477469e-02 -2.44299751e-02
  4.43205424e-02  6.04213914e-03 -9.87158567e-02 -2.39819735e-02
  5.14506036e-03 -3.58484872e-02 -2.01977207e-04 -5.41434288e-02
 -2.59671789e-02  4.86338697e-02 -3.35091650e-02  4.88894470e-02
  2.24703439e-02 -5.23224240e-03 -2.98410710e-02 -6.04826920e-02
  3.33060175e-02 -4.76282053e-02  1.68485716e-02 -9.11734067e-03
 -4.86214310e-02  3.77485417e-02 -7.61242658e-02  2.54818182e-02
 -1.55817708e-02  4.44219681e-03 -3.39164622e-02  2.36002989e-02
  4.07381682e-03 -1.35884620e-02  9.87138078e-02  8.01654765e-04
  1.22988201e-03  7.81539530e-02  4.01597694e-02  9.39631835e-03
  3.26985531e-02 -2.79566944e-02 -4.44548577e-03  4.87083159e-02
 -5.12801521e-02  2.54229438e-02  7.84498453e-02  1.85343046e-02
  2.22968087e-02  7.44748395e-03 -2.49355771e-02  2.50995159e-02
 -1.13100614e-02 -1.38619440e-02  4.97008637e-02 -3.87298763e-02
  3.19258645e-02  3.06394082e-02  1.45602245e-02 -3.06480259e-01
  3.14189643e-02  1.55238481e-02  3.95083055e-02  4.21461137e-03
  4.39437060e-03  4.07611318e-02  4.23378497e-02 -6.52193874e-02
 -4.72155362e-02 -5.30188717e-02  4.91406992e-02  2.64510773e-02
  5.65333366e-02  4.45330981e-03  1.83838122e-02  3.57843041e-02
 -7.65036643e-02  5.64618222e-03 -7.78196007e-02 -2.91063841e-02
 -5.31248236e-03  2.12200537e-01 -3.86888683e-02  2.07084045e-02
  4.78326268e-02  1.77992154e-02  1.40441302e-02  4.93167676e-02
  3.54827717e-02  2.53306180e-02  9.70550522e-04  4.83256541e-02
 -1.22486372e-02  4.39608283e-02  6.65819123e-02 -5.01257852e-02
  5.73904999e-02  1.76415928e-02 -6.04805071e-03 -5.38796112e-02
  2.03450620e-02 -2.09667403e-02 -1.64461825e-02  1.48636885e-02
 -6.78739175e-02  7.89078011e-04 -2.29302719e-02 -1.84757158e-03
 -3.19478884e-02 -3.71378437e-02  1.94355305e-02 -1.51093462e-02
 -2.31932127e-03  8.43566190e-03  4.55260091e-02 -3.52113098e-02
  3.08261644e-02 -3.59199345e-02 -1.78753992e-03  6.51343763e-02
 -6.86878264e-02 -1.08473003e-02  2.78245937e-02  3.38958353e-02]",53
17012,11,1437.0,"```

For Stable Diffusion 2 base (Hub id: `stabilityai/stable-diffusion-2-base`):

```shell
python -m python_coreml_stable_diffusion.pipeline --prompt ""a photo of an astronaut riding a horse on mars"" --compute-unit ALL -o output --seed 93 -i models/coreml-stable-diffusion-2-base_original_packages --model-version stabilityai/stable-diffusion-2-base","[-4.19090874e-02 -3.28335054e-02  1.03367725e-02  2.31761634e-02
  8.88564531e-03 -2.84049264e-03 -1.28361378e-02  6.56837039e-03
  1.31210350e-02  2.68754419e-02  4.09361497e-02 -1.30846471e-01
  7.10158274e-02 -1.38727110e-02 -1.22575192e-02  3.17178220e-02
 -4.91705118e-03  5.12501076e-02 -5.93764562e-05  8.06854980e-04
  1.33969551e-02  1.70250726e-03 -2.16295756e-02 -5.09157553e-02
  3.01639903e-02  3.80966030e-02 -4.33488376e-02 -3.20991181e-04
 -3.81239764e-02 -2.11388260e-01  2.94205714e-02 -5.89023940e-02
  2.56536398e-02 -3.46270390e-02  4.58637864e-04  5.82453981e-03
 -5.67544065e-03  6.42361306e-03 -4.06621993e-02  6.65644854e-02
  4.10144627e-02 -1.64540112e-02  8.02399218e-03 -8.12942907e-03
 -1.79476216e-02 -5.00045642e-02 -3.96956392e-02 -4.94748540e-02
  5.71159124e-02 -3.75457108e-02  4.18966077e-02 -6.79903254e-02
  6.25286205e-03  2.34164651e-02  7.53581244e-03  3.01584639e-02
  4.13175821e-02  5.67243584e-02  4.38969620e-02  1.51475212e-02
 -3.49884736e-04  7.20307007e-02 -2.28244811e-01  7.27441311e-02
  3.59882675e-02  2.29282174e-02 -6.06622882e-02 -5.26139624e-02
  1.03851501e-02  4.08337340e-02 -3.09062172e-02  3.70272845e-02
  1.80846769e-02  3.11337523e-02  1.19933821e-02 -1.95009876e-02
  1.39664654e-02 -7.56152347e-03 -6.50524301e-03 -1.87866744e-02
 -2.97046383e-03 -5.37364045e-04 -4.08860072e-02 -2.55050100e-02
 -2.06973422e-02 -1.93429794e-02  2.96676494e-02 -4.30858061e-02
  2.53555831e-02  3.05250958e-02 -7.86540285e-02 -4.26454954e-02
  4.04280564e-03  7.38577917e-02 -9.03055146e-02  2.61516515e-02
  4.74980548e-02  1.18577969e-03 -3.14635038e-02  2.06059784e-01
 -2.71164328e-02  2.65061688e-02  4.23035286e-02  2.06435360e-02
  4.15691845e-02 -3.71389277e-02 -6.94841240e-03 -2.23654676e-02
 -2.09243912e-02 -9.67621151e-03  3.06199607e-03 -1.82353985e-02
  2.34232210e-02 -2.93937866e-02  2.99617462e-02 -3.35056987e-03
  1.17882574e-02 -2.32204073e-03 -4.07069810e-02 -1.35703599e-02
  1.29061313e-02  1.61114596e-02  5.72068095e-02  6.47392217e-03
  2.33137663e-02 -8.36591236e-03  8.41233507e-02  1.15462072e-01
  1.43488701e-02  1.81841515e-02  7.98973367e-02  1.33245427e-04
 -2.76397076e-02 -1.38889253e-02 -3.12205907e-02  3.49516273e-02
  2.82303640e-03  1.26036005e-02  1.01043284e-03 -1.53936120e-02
 -1.90049782e-02 -1.13793239e-01 -1.31816166e-02 -6.82674199e-02
 -7.59106129e-02  1.39314756e-01  2.39697825e-02  6.17054105e-02
 -3.21335904e-02 -2.77006067e-02 -1.92583241e-02  9.19210259e-03
 -1.26720304e-02 -2.06871815e-02  3.26737463e-02  4.82750982e-02
  1.03062876e-02  7.71903619e-02 -6.44683242e-02  3.53638530e-02
 -3.85819674e-02 -1.03053965e-01 -5.41778766e-02  1.25544280e-01
 -2.17089383e-03 -7.18877092e-02 -1.82465278e-02 -1.32869063e-02
 -9.86005296e-04 -2.27155406e-02  7.10384399e-02  2.89268233e-02
 -3.59463878e-02  1.66069902e-02  5.19132726e-02 -1.32851291e-03
 -5.28301597e-02  3.17384116e-03  2.56129559e-02  1.36740925e-02
  2.82844864e-02 -2.79809311e-02 -4.16479185e-02  1.72893051e-02
  2.13033985e-02 -2.82744989e-02 -4.13309634e-02 -2.58427151e-02
 -3.63614003e-04  2.96077281e-02 -2.57093236e-02  6.12461343e-02
 -4.05356921e-02 -2.80052889e-02 -5.46751730e-02 -3.59007642e-02
 -1.63233634e-02 -1.58336051e-02  1.58834215e-02 -3.25895064e-02
  7.43120760e-02  2.24608388e-02 -5.17009795e-02 -1.76952430e-03
 -7.21665248e-02  1.07079213e-02 -3.64759862e-02  1.83710910e-03
 -4.65935702e-03  3.18848863e-02 -3.14096622e-02 -2.81052664e-02
  5.16119376e-02 -1.49635598e-02 -4.46415283e-02  3.32021713e-02
 -1.36211133e-02  3.91656673e-03  3.25330682e-02  3.62893641e-02
  5.61441891e-02 -6.21683560e-02 -5.06854393e-02 -2.78359562e-01
  2.20491644e-02  4.08992693e-02  1.77217089e-02  4.18307036e-02
 -5.88726103e-02  5.47250062e-02 -3.13846096e-02  4.05535623e-02
  8.13749358e-02  9.45180655e-02 -2.88668573e-02  6.29975880e-03
  2.79523549e-03 -4.71465327e-02  3.14435139e-02  4.66597360e-03
 -1.04721012e-02  1.51904151e-02 -2.07883026e-02  3.51733901e-02
 -3.09148002e-02 -3.87266167e-02 -6.99476674e-02  5.79173937e-02
 -9.49462131e-03  2.15491414e-01  4.19501998e-02  4.72212620e-02
  1.02892099e-02  5.49375527e-02 -3.74984113e-03 -1.50058949e-02
 -1.07486174e-01  3.71987782e-02  5.68284793e-03  4.79755886e-02
 -1.62838455e-02 -1.54571841e-02 -3.74679863e-02 -1.13239000e-02
  3.99574377e-02  1.99834257e-03 -4.70799766e-02 -1.32857384e-02
 -1.58778448e-02 -2.91299950e-02  3.11251041e-02 -3.18197198e-02
  7.98272062e-03  7.26326779e-02 -1.39652528e-02  1.49709370e-03
 -3.84171749e-03 -4.29357681e-03 -2.34525539e-02 -5.80036975e-02
 -8.81159864e-03 -2.60019619e-02  6.84865238e-03 -1.58277899e-02
 -6.48403540e-02  2.29076203e-02 -4.12436239e-02  5.76198809e-02
 -3.14964019e-02  1.08753354e-03 -5.86810485e-02  3.06333825e-02
 -7.15854168e-02  5.66009134e-02  1.11425847e-01 -1.68937184e-02
  2.36041732e-02  4.71217409e-02  1.30857332e-02  2.25580437e-03
  2.18494926e-02 -1.80386044e-02 -3.82753909e-02  2.67892834e-02
 -3.83017659e-02  5.85991554e-02  5.97220771e-02  5.59978522e-02
  4.42732265e-03  1.80086363e-02 -2.12869197e-02  9.69930664e-02
 -3.17964777e-02 -1.54693611e-02  1.57182012e-02 -3.39292400e-02
  1.65558700e-02  2.71836147e-02  1.58283338e-02 -2.95115858e-01
  3.51934843e-02 -1.53270839e-02  4.18297686e-02 -9.13085230e-03
  3.30754332e-02  3.89103666e-02  3.90936546e-02 -8.70461985e-02
 -3.29551622e-02 -3.83249223e-02  5.16730286e-02  6.40812218e-02
  3.25247794e-02 -1.71095282e-02  2.87080538e-02  5.30552007e-02
 -8.03616419e-02  2.01847516e-02 -7.19885081e-02  1.43445106e-02
  3.36379558e-02  1.81821123e-01 -3.47693041e-02 -2.20039696e-03
  1.23206135e-02 -3.10195349e-02  3.37092318e-02  3.19921039e-02
 -1.59885304e-03 -7.64246142e-05  1.62654798e-02  3.55748124e-02
 -5.39833345e-02  2.32439712e-02  6.84472993e-02 -4.19496708e-02
  4.22063209e-02  2.38452666e-02 -2.99238190e-02  8.22904799e-03
  1.81795806e-02 -8.45487788e-03 -2.86051910e-02  8.33444744e-02
 -4.66248393e-02 -4.45845583e-03 -4.67753485e-02  6.71862159e-03
  1.46065084e-02 -3.51424739e-02 -1.84733868e-02 -4.59628031e-02
  1.76941715e-02  7.00940043e-02  3.49834673e-02 -1.51353236e-03
 -1.82949286e-02 -3.89500298e-02 -1.57201663e-02  3.79582047e-02
 -9.01290253e-02  4.00097892e-02  1.50237023e-03 -2.33440381e-02]",53
11627,26,989.0,"```py
controlnet = ControlNetModel.from_pretrained(
    ""diffusers/controlnet-canny-sdxl-1.0"",
    torch_dtype=torch.float16,
    use_safetensors=True
)
vae = AutoencoderKL.from_pretrained(""madebyollin/sdxl-vae-fp16-fix"", torch_dtype=torch.float16, use_safetensors=True)
pipe = StableDiffusionXLControlNetPipeline.from_pretrained(
    ""stabilityai/stable-diffusion-xl-base-1.0"",
    controlnet=controlnet,
    vae=vae,
    torch_dtype=torch.float16,
    use_safetensors=True
)
pipe.enable_model_cpu_offload()","[-7.49169067e-02 -9.51705221e-03  3.93812098e-02 -3.17015350e-02
  2.92283855e-02  1.59361027e-02  2.34263993e-04  3.08303931e-03
  5.96481981e-03 -1.14947129e-02 -3.14737484e-02 -7.47298896e-02
  3.75916958e-02  2.72568390e-02 -3.25740613e-02  4.86516170e-02
 -1.74933523e-02  3.84650007e-02 -3.87734734e-02  4.63722926e-03
  3.31495404e-02 -2.02604868e-02 -2.35672910e-02 -4.45894040e-02
  4.68504801e-02  4.92342399e-04 -3.05098724e-02 -2.79642027e-02
 -1.31137697e-02 -2.32251242e-01 -1.34206098e-02 -6.21758252e-02
  2.41828691e-02 -5.38599603e-02 -7.17186788e-03 -3.29615064e-02
 -2.61358414e-02  1.46517828e-02 -1.91719849e-02  6.11459613e-02
  1.88446250e-02 -1.87823735e-02 -2.61903778e-02 -6.84522390e-02
 -3.09468550e-03 -3.38515155e-02 -2.94134859e-02 -1.81199480e-02
  6.87238574e-02 -3.71184386e-02  1.51668992e-02 -1.50314737e-02
  1.33251771e-02  1.29226958e-02  1.82269532e-02  2.99517419e-02
  4.67540771e-02  4.94895875e-02  2.40112171e-02  2.55390089e-02
  1.40228989e-02  5.31615168e-02 -2.40239337e-01  8.79599005e-02
  4.24367860e-02  1.16567947e-02 -2.78023668e-02 -4.83248644e-02
  5.77687658e-02  5.06786704e-02 -5.43519557e-02  5.21418862e-02
  2.74441931e-02  4.62887734e-02  1.12641295e-02 -3.88910472e-02
 -8.71738326e-03 -2.18598433e-02 -6.10471191e-03  4.50096242e-02
 -3.09248874e-03 -1.29572358e-02 -1.42580401e-02 -1.87673289e-02
 -1.29342126e-02  7.03938399e-03  7.64639080e-02 -3.84652242e-02
  4.88283485e-02 -9.57433786e-03 -8.17069858e-02 -1.58755928e-02
  5.59167424e-03  7.01642185e-02 -5.59043139e-02 -3.56183276e-02
  7.54931495e-02  1.54320640e-03 -4.74545993e-02  2.21694544e-01
 -4.42509912e-02 -3.56697030e-02 -1.22096390e-02  2.30853297e-02
  2.86175311e-02 -1.89352650e-02  4.52950457e-03 -2.15825494e-02
 -1.34249711e-02 -9.44823213e-03  1.35243814e-02 -1.45365437e-02
  4.26754355e-02 -5.00486530e-02  4.29065116e-02 -9.53562371e-03
 -2.23372132e-03 -3.49396765e-02 -5.49556799e-02  4.18701256e-03
  1.41011663e-02  2.55252495e-02  3.49423960e-02  8.59154854e-03
  1.78934596e-02  8.93467222e-05  4.97818887e-02  1.13172933e-01
 -1.79534648e-02  4.98630330e-02  6.22108653e-02 -1.77032854e-02
 -5.15911132e-02 -1.34486463e-02 -3.81774665e-03  6.12718798e-03
  1.83486231e-02 -1.69331059e-02  2.06554625e-02 -2.66427267e-02
 -6.00091964e-02 -7.36185461e-02 -1.46793071e-02 -1.14599206e-01
 -1.63687114e-02  9.74631160e-02 -4.68491986e-02  7.02261776e-02
 -1.68076567e-02 -2.44781729e-02 -5.58160469e-02  8.48543551e-03
 -3.29343677e-02 -2.08784807e-02  3.97636965e-02  5.79651222e-02
  1.91916656e-02  7.68672153e-02 -5.63990548e-02  3.18917148e-02
 -4.34541889e-02 -6.65279254e-02 -3.82414423e-02  8.66049081e-02
 -4.34213434e-04 -8.50057974e-02  1.71146486e-02 -2.08675619e-02
 -3.16810310e-02 -2.33312175e-02  7.59281917e-03 -1.01240752e-02
 -5.70665449e-02 -1.29641304e-02  4.37270552e-02  1.54677182e-02
 -3.79512236e-02  8.85356031e-03  8.50897282e-03  1.76023711e-02
  3.91629487e-02 -2.70362534e-02 -6.99885376e-03  1.86030734e-02
  3.08836475e-02 -6.59012720e-02 -1.33037884e-02 -4.53421660e-02
  2.07750462e-02  8.00812617e-02 -5.56675158e-02  1.33482544e-02
 -3.14618312e-02 -2.94152834e-02 -4.49461490e-02 -1.34207560e-02
 -3.13073583e-02 -2.43640225e-02 -1.04956180e-02 -2.86117420e-02
  6.53017834e-02  6.52074292e-02 -1.46666160e-02 -5.53790294e-03
 -5.08126430e-02  4.13027778e-02 -4.27892208e-02  1.34166004e-03
  6.15921021e-02  7.38313422e-03 -5.12023270e-02 -7.76872691e-03
  6.57404214e-02 -1.98030137e-02 -7.50724673e-02  3.14660668e-02
 -3.06079779e-02  2.20463183e-02  3.14921774e-02  3.68937775e-02
  3.92228290e-02 -2.36658137e-02 -8.33580568e-02 -2.49103457e-01
  4.91998009e-02  1.71940271e-02 -4.25438918e-02  4.75627892e-02
 -2.10880917e-02  2.53232978e-02 -2.02679709e-02 -1.17510613e-02
  6.95500150e-02  1.03832521e-01  7.23666744e-03  2.60746144e-02
  1.14832623e-02 -5.01733385e-02  5.04301265e-02  5.47724450e-03
 -6.07357826e-03 -3.21127623e-02 -1.50025208e-02  1.35934250e-02
 -4.77713570e-02  8.37287691e-04 -8.45477134e-02  4.35908623e-02
 -3.47502269e-02  2.08276421e-01 -3.49313207e-02  5.46105504e-02
 -2.30793077e-02  4.47336212e-02  4.07951102e-02 -2.16831900e-02
 -9.97530594e-02  5.15252352e-02  4.55259383e-02  5.36356084e-02
  2.26672012e-02  3.22129205e-02  8.01922847e-03 -5.19478507e-03
  4.27899770e-02 -4.86775069e-03 -1.15395471e-01 -1.95706356e-02
 -2.25505270e-02 -2.36471705e-02  1.68314800e-02 -7.96055123e-02
  1.56037766e-03  4.74682152e-02  1.50722368e-02  6.00573532e-02
  2.67309528e-02  1.02759898e-02 -3.02074291e-02 -7.01837838e-02
  3.42920721e-02 -6.00499623e-02  4.24103551e-02 -2.16347706e-02
 -3.50209400e-02  6.17579836e-03 -7.09790736e-02  3.20444703e-02
 -1.08486777e-02 -7.40471343e-03 -7.00552836e-02  7.36196563e-02
  1.62429817e-03  7.94001855e-03  9.55255926e-02  8.62380397e-03
  3.76589336e-02  3.80807146e-02  2.25136578e-02 -8.36336985e-03
  2.24498920e-02 -2.80876756e-02  1.34708891e-02  9.63766966e-03
 -2.78427787e-02  3.56136970e-02  7.91407153e-02  6.06930964e-02
 -6.47508947e-04  9.84332804e-03  2.25705020e-02  6.67055622e-02
  2.38360604e-03 -7.97137991e-02  4.55586240e-02 -2.89204400e-02
  2.25709807e-02  6.19862899e-02  1.74787473e-02 -2.82498240e-01
  4.04834449e-02  3.35346647e-02  3.75932083e-02 -2.75894664e-02
  2.64489949e-02  6.32163808e-02  2.40216497e-02 -8.50150585e-02
 -2.85139177e-02 -6.36085942e-02  2.04717033e-02  5.55724949e-02
  2.85559427e-02 -1.78079382e-02  2.19453890e-02  5.05628996e-02
 -5.89832775e-02  3.76252085e-02 -2.50333566e-02 -2.68372372e-02
  3.64059545e-02  1.79300055e-01 -3.14045623e-02  4.73916270e-02
  2.51658149e-02 -2.58343350e-02  1.97867472e-02  5.83392084e-02
  2.81499773e-02  3.75202894e-02  3.75778018e-03  4.96492051e-02
 -1.60195380e-02  4.77461070e-02  2.52822600e-02 -5.52066341e-02
  3.06911282e-02  5.86685613e-02 -7.77451880e-03 -2.94647794e-02
 -3.37009854e-03 -2.84302086e-02 -3.89806516e-02  4.73776162e-02
 -2.93577481e-02 -1.68680269e-02 -3.82035300e-02  5.30635752e-03
 -2.31881815e-04 -1.17720533e-02  3.18932980e-02  8.09747551e-04
  3.42037417e-02  4.19886857e-02  2.24104021e-02 -2.54742038e-02
 -1.99103039e-02 -1.96090415e-02 -3.47628258e-02  4.92957421e-02
 -1.15567513e-01  2.87267435e-02  1.84671171e-02  8.39393586e-03]",53
16866,14,1422.0,"```

### DeepFloyd IF text-to-image + upscaling

```python
from diffusers import DiffusionPipeline
import torch

run_compile = True  # Set True / False

pipe_1 = DiffusionPipeline.from_pretrained(""DeepFloyd/IF-I-M-v1.0"", variant=""fp16"", text_encoder=None, torch_dtype=torch.float16, use_safetensors=True)
pipe_1.to(""cuda"")
pipe_2 = DiffusionPipeline.from_pretrained(""DeepFloyd/IF-II-M-v1.0"", variant=""fp16"", text_encoder=None, torch_dtype=torch.float16, use_safetensors=True)
pipe_2.to(""cuda"")
pipe_3 = DiffusionPipeline.from_pretrained(""stabilityai/stable-diffusion-x4-upscaler"", torch_dtype=torch.float16, use_safetensors=True)
pipe_3.to(""cuda"")


pipe_1.unet.to(memory_format=torch.channels_last)
pipe_2.unet.to(memory_format=torch.channels_last)
pipe_3.unet.to(memory_format=torch.channels_last)","[-5.57346381e-02 -2.15716679e-02  2.91210059e-02  6.25382550e-03
  2.95164995e-02 -6.67733466e-03 -9.62176640e-03 -2.33447067e-02
 -7.25220051e-03  9.83880553e-03 -2.44806847e-03 -9.67801511e-02
  4.80567105e-02 -7.26435194e-03 -1.97348315e-02  4.01432477e-02
 -2.58876868e-02  2.12449096e-02 -7.95800760e-02 -1.46030681e-02
  4.46666628e-02  6.23861124e-05  4.89381282e-03 -7.47233331e-02
  5.64792939e-02  8.00596457e-03  1.61160924e-03 -1.10451439e-02
 -1.81967001e-02 -2.15907976e-01 -2.68302718e-03 -4.51040007e-02
  1.93518605e-02 -7.06975684e-02  4.65245498e-03 -5.41485362e-02
 -2.41091363e-02  4.10308242e-02 -1.68426316e-02  6.61994070e-02
  4.10754932e-03  5.26335463e-03 -4.42208759e-02 -3.47759761e-02
 -2.79758517e-02 -7.66076669e-02 -6.45913705e-02 -1.87303964e-02
  1.58290751e-02 -2.43804343e-02  2.20632590e-02 -1.53808808e-02
  1.58920102e-02  1.63207036e-02 -3.67575767e-03  3.05847060e-02
  5.30179404e-02  1.55475549e-02  5.13355285e-02  2.12541260e-02
  3.23423259e-02  5.68972789e-02 -2.12211356e-01  8.56712610e-02
  1.33560756e-02  1.06046218e-02 -8.01219139e-03 -6.42594174e-02
  2.88155563e-02  6.79218695e-02 -5.55820055e-02  4.21380997e-02
  2.10621674e-02  6.26091510e-02 -1.81335211e-03 -5.36788478e-02
 -4.99961199e-03 -2.35750154e-02  1.47245603e-03  4.43694815e-02
  1.79995131e-02  2.31496338e-02 -1.82741527e-02 -3.80229577e-02
 -1.40938966e-03 -2.89631914e-02  4.73565683e-02 -5.38401045e-02
  7.33946543e-03 -1.46388682e-02 -8.84643868e-02 -3.74048650e-02
 -2.24930588e-02  4.84419279e-02 -7.22439587e-02 -1.39451893e-02
  6.88259229e-02  1.08682243e-02 -2.93451808e-02  1.93081215e-01
 -5.35938032e-02  9.50341020e-03  1.22826127e-03  1.39571382e-02
  2.09989268e-02  1.67042471e-03 -1.71909947e-03  4.79678158e-04
 -3.42036188e-02 -1.37662562e-02 -2.81180185e-03 -3.94974202e-02
  5.87814189e-02  2.20646174e-03  2.78555527e-02  7.83570576e-03
  2.03514397e-02 -5.38625289e-03 -4.83547710e-02  6.63584983e-03
 -1.35030346e-02 -3.86719801e-03  2.52637472e-02 -6.60312874e-03
 -3.10633145e-03 -2.16661319e-02  4.52902019e-02  9.91146788e-02
 -1.85256209e-02  4.88002598e-02  5.07030301e-02 -1.17869275e-02
 -2.99443938e-02  1.47820339e-02 -3.22319642e-02  5.91144562e-02
  9.27146431e-03 -5.35733113e-03  2.14359649e-02 -8.81015044e-03
 -3.08520496e-02 -9.00667608e-02 -1.71125606e-02 -7.25499541e-02
 -8.12182948e-03  9.70601887e-02 -5.35002947e-02  7.32242763e-02
 -4.38195951e-02 -4.62573990e-02 -2.70934049e-02  1.47862881e-02
 -2.88140066e-02 -3.16164456e-02  4.82994169e-02  3.66491340e-02
  1.65651049e-02  8.09648484e-02 -3.75620164e-02  2.10150369e-02
 -3.04853059e-02 -7.82791600e-02 -5.57292141e-02  1.00639880e-01
  4.85664653e-03 -5.91526665e-02 -2.79372167e-02 -3.00191082e-02
 -1.19086253e-02 -2.99661923e-02  4.23717834e-02  1.57992076e-02
 -2.10400354e-02 -1.76060945e-02  1.02399103e-02  1.51958764e-02
 -5.31431623e-02 -4.27818159e-03  2.87263189e-02  2.64797024e-02
  5.34263551e-02  1.43790236e-02  8.40209890e-03  2.63202209e-02
  4.42264080e-02 -7.63416365e-02 -2.62854807e-02 -5.27876541e-02
  2.21205689e-02  6.86971471e-02 -4.25682478e-02  3.02884243e-02
 -4.01021056e-02 -7.97632784e-02 -3.93184572e-02 -3.05442954e-03
 -9.97586176e-03 -3.68448459e-02 -1.72367990e-02 -3.76853533e-02
  3.82334143e-02  5.27719073e-02 -1.40257003e-02 -1.85737628e-02
 -5.12476005e-02  2.31443178e-02 -3.19887586e-02 -2.69220211e-02
  5.81514724e-02  9.67729278e-03 -4.75720391e-02 -3.54286358e-02
  8.10179785e-02 -9.29903798e-03 -3.19802277e-02 -3.96442134e-03
  1.49998488e-02  2.97755506e-02  1.31926341e-02  5.35972491e-02
  4.68109436e-02 -5.62586188e-02 -7.18047470e-02 -2.34861448e-01
  2.22401414e-02  8.87801796e-02 -1.37025509e-02  6.81974590e-02
 -3.09655685e-02  4.21258360e-02 -1.06316702e-02 -1.62473170e-03
  9.95968878e-02  8.97364691e-02 -3.54378819e-02  4.83835787e-02
 -1.36425104e-02 -2.76214574e-02  2.33562849e-02  1.07417116e-02
  1.97433997e-02 -1.39182508e-02  1.68021675e-02 -8.49444047e-03
 -4.15793434e-02  1.05201006e-02 -9.67780575e-02  3.49744558e-02
 -3.21952812e-02  2.36256719e-01  2.17587911e-02  3.00117452e-02
 -6.57083932e-03  4.96127047e-02  3.53638828e-02 -2.37641633e-02
 -9.83773097e-02  6.11780658e-02  1.41681079e-02  4.36879359e-02
  3.94076928e-02 -1.17967352e-02 -2.36681197e-02 -2.54977960e-03
  4.70442362e-02 -2.56300205e-03 -1.02127485e-01 -2.14344729e-03
 -3.96750607e-02 -3.20114829e-02  2.59570144e-02 -3.38778570e-02
  1.96827967e-02  7.60507733e-02 -1.09553691e-02  3.37343514e-02
  2.55928766e-02  2.71196431e-03 -3.47541273e-02 -1.02585785e-01
  4.40976806e-02 -2.89660394e-02 -1.30399037e-02 -2.22359970e-02
 -3.11547816e-02  1.21379225e-02 -3.28461304e-02  3.96460369e-02
 -1.20334933e-02  1.68584213e-02 -4.93133925e-02  4.71134447e-02
 -9.84004419e-03  2.58254632e-02  8.01191181e-02 -2.86163967e-02
  4.72262576e-02  5.34906648e-02  5.72487637e-02  1.04438933e-02
  3.54496390e-02 -1.43925967e-02  8.95207375e-03  4.71418649e-02
 -1.73666980e-02  4.12529260e-02  5.84365837e-02  3.41751389e-02
  2.37975921e-02  2.27123350e-02 -4.26135812e-04  3.23042609e-02
 -1.76059864e-02 -1.50553021e-03  2.40459759e-02 -5.11306487e-02
  1.39317643e-02  1.65759157e-02  3.87658179e-03 -3.19308758e-01
  1.81056615e-02  3.80551033e-02  1.16062155e-02 -1.82977132e-02
  1.15822731e-02  5.65751009e-02  4.93623763e-02 -9.74477157e-02
 -1.67700090e-02 -9.35296640e-02  2.00135149e-02  4.94856983e-02
  4.65404652e-02 -5.80618810e-03  3.88799757e-02  6.04901314e-02
 -5.41901179e-02  4.74719331e-02 -6.91473559e-02  5.73157845e-03
  2.00754441e-02  2.01729968e-01 -6.19836859e-02  1.54728340e-02
 -1.81642710e-03  1.05882669e-02  1.37954298e-02  5.57264946e-02
  8.48956965e-03  2.38020085e-02  1.44997993e-02  8.28000382e-02
 -2.89505143e-02  6.30748048e-02  8.59743729e-02 -4.64853570e-02
  4.02375050e-02  1.83225740e-02 -2.31051147e-02  3.33369686e-03
  2.31531486e-02 -3.10675111e-02 -3.19321826e-02  5.55994771e-02
 -7.47174677e-03  1.01903062e-02 -2.87687238e-02 -1.61735024e-02
 -3.14544351e-03 -4.04230393e-02  3.09858341e-02 -3.84175801e-03
  1.10864695e-02  6.65047169e-02  1.34915290e-02 -5.25946468e-02
  2.63989175e-04 -3.17804031e-02 -3.65772471e-02  2.19097783e-04
 -1.08355321e-01 -3.90338874e-03  2.88481321e-02  2.24730279e-03]",53
17050,27,1440.0,"```py
from diffusers import StableDiffusionXLPipeline
import torch

pipeline = StableDiffusionXLPipeline.from_pretrained(
    ""stabilityai/stable-diffusion-xl-base-1.0"", torch_dtype=torch.float16, variant=""fp16"", use_safetensors=True
).to(""cuda"")

prompt = ""Astronaut in a jungle, cold color palette, muted colors, detailed, 8k""
image = pipeline(prompt=prompt, crops_coords_top_left=(256, 0)).images[0]
image","[-5.61058149e-02 -1.87071208e-02  2.30511799e-02 -2.53214035e-02
  1.87209453e-02  1.49893407e-02 -8.72348808e-03 -1.92363821e-02
 -6.95106806e-03  1.41749177e-02  2.79537798e-03 -1.08813114e-01
  3.06782797e-02  6.86215423e-03 -4.35060076e-02  3.13739926e-02
 -1.87861044e-02  3.18421014e-02 -5.14529310e-02 -2.67350469e-02
  2.01276839e-02  5.28930267e-03 -1.72246508e-02 -7.11313635e-02
  2.81377211e-02  1.58934966e-02 -4.18165699e-02 -2.30742414e-02
 -2.25541573e-02 -2.27837041e-01 -6.51305635e-03 -5.77919595e-02
  4.09702882e-02 -5.13463207e-02 -1.03240553e-02 -2.07402860e-03
 -1.08210016e-02  2.71289162e-02 -1.88551713e-02  5.57911359e-02
  8.84449761e-03 -1.43533852e-02 -1.92484949e-02 -4.15599346e-02
 -2.13569533e-02 -7.12757781e-02 -5.56839593e-02 -3.10681947e-02
  6.20635487e-02 -2.16392595e-02  1.79995466e-02 -4.78430875e-02
 -3.43205211e-05  1.37993100e-03 -3.31327843e-04  3.75711955e-02
  6.55807704e-02  1.79010350e-02  4.70325686e-02  2.72139851e-02
  2.25216486e-02  3.82994674e-02 -2.15247005e-01  9.54625309e-02
  3.04608513e-02  1.22145470e-02 -5.35821803e-02 -5.57865649e-02
  1.93619337e-02  4.19749245e-02 -5.27569838e-02  4.77979220e-02
  3.38003635e-02  3.80646549e-02  8.84154160e-03 -5.55691384e-02
 -1.24604218e-02 -3.39789428e-02 -8.87452997e-03  1.90319736e-02
 -9.41892900e-03 -4.72311489e-03 -2.67743021e-02 -4.67834854e-03
 -5.85477659e-03 -6.19179243e-03  5.19257709e-02 -4.92327362e-02
  4.27512527e-02  5.40538412e-03 -9.34544057e-02 -4.58882228e-02
 -1.37744611e-02  6.27445132e-02 -6.78870752e-02 -2.67447289e-02
  7.95264840e-02  8.71064141e-04 -2.06733197e-02  1.96270779e-01
 -5.66682443e-02 -2.91257910e-03  1.64028388e-02  4.08361331e-02
  1.74240619e-02 -2.24184450e-02  2.88158888e-03 -2.45950632e-02
 -2.04782449e-02 -1.89839955e-02  1.45956650e-02 -3.71293426e-02
  4.49552089e-02 -2.86794230e-02  1.70720322e-03 -8.75145197e-03
 -1.10962940e-02 -2.59354115e-02 -3.51813696e-02  1.66842286e-02
 -1.12443296e-02  4.11190651e-03  3.39570381e-02  2.47441083e-02
  1.17344419e-02 -2.42506270e-03  5.19782938e-02  9.80111733e-02
  4.72834846e-03  5.90114258e-02  8.56397450e-02  3.26015963e-03
 -3.73938791e-02  1.38231749e-02 -2.56074797e-02  4.72536236e-02
  2.32822727e-02 -2.40737898e-03  1.09660504e-02 -1.68946739e-02
 -3.54693867e-02 -8.84011611e-02 -2.27897950e-02 -9.30461138e-02
  5.98461740e-03  1.06396310e-01 -4.54672761e-02  7.12170750e-02
 -1.51650691e-02 -1.41429221e-02 -3.41235995e-02  8.67225323e-03
  9.33717843e-03 -1.30348634e-02  4.89964709e-02  6.36206791e-02
  2.04281323e-02  7.92062879e-02 -2.65556946e-02  4.14523482e-02
 -2.03658734e-02 -9.17362943e-02 -5.40159494e-02  1.02921851e-01
 -2.71299132e-03 -8.13758597e-02  1.05015212e-03 -2.23105643e-02
 -2.91020200e-02 -2.86071654e-02  3.83287333e-02  1.71002857e-02
 -2.65716612e-02  3.44496104e-03  2.57301591e-02  2.18542609e-02
 -6.14951551e-02 -2.70774122e-03  4.39792462e-02  1.19529506e-02
  6.31444231e-02 -3.85033973e-02  8.65480024e-03  2.41947658e-02
  2.81012133e-02 -6.43360466e-02 -4.17715870e-02 -2.11759061e-02
  1.88345239e-02  8.63378271e-02 -2.69283056e-02  2.34932248e-02
 -2.89934240e-02 -4.29819785e-02 -4.60352823e-02 -2.55492106e-02
 -1.20008746e-02 -4.71479930e-02 -1.15530593e-02 -2.08325777e-02
  7.40336552e-02  3.84208858e-02 -2.52842754e-02  1.42016904e-02
 -3.85949463e-02  2.30317134e-02 -3.06445230e-02 -1.68245025e-02
  4.97133732e-02  1.46549260e-02 -6.72252551e-02 -1.87210478e-02
  5.08418716e-02 -1.35909822e-02 -4.92754057e-02  1.87721066e-02
  7.73619860e-03 -6.58560637e-03  2.70919874e-02  4.97145504e-02
  3.26804668e-02 -5.50626442e-02 -8.86741355e-02 -2.63662070e-01
  3.62533890e-02  6.23771213e-02 -7.79231021e-04  5.73090389e-02
 -3.84906381e-02  5.77784665e-02  3.70375370e-03  2.32448019e-02
  9.12508592e-02  1.09605268e-01 -3.28165404e-02  5.42749166e-02
 -5.88715216e-03 -3.16161811e-02  1.56822465e-02  6.55803178e-03
  5.19831665e-03 -3.15584103e-03 -4.39250004e-03 -4.93621128e-03
 -4.23190556e-02 -2.37681456e-02 -8.25494900e-02  4.96575534e-02
 -3.17320712e-02  2.16364682e-01  2.26559583e-02  8.71460326e-03
 -2.07226221e-02  4.72091623e-02  1.49926255e-02 -3.13334577e-02
 -1.27445027e-01  3.67662385e-02  2.72641946e-02  2.83522289e-02
  8.02052673e-03  9.61230975e-03 -5.18328324e-03  1.66493617e-02
  4.99310419e-02 -1.33207440e-03 -6.09219819e-02 -5.65336738e-03
 -3.77197042e-02 -2.68884078e-02  4.12782654e-02 -5.15623651e-02
  1.52036296e-02  5.78031279e-02 -1.47469351e-02  4.84426133e-02
  1.01724891e-02  2.03916430e-03 -4.58888523e-02 -5.57030961e-02
  4.42876145e-02 -3.20637822e-02  2.20020618e-02 -3.12681086e-02
 -6.19498901e-02  3.57993990e-02 -2.46346947e-02  2.60287896e-02
 -1.13183623e-02  8.14432092e-03 -5.08795530e-02  8.25433731e-02
 -2.78945360e-02  2.05135606e-02  1.01370454e-01 -6.91359816e-03
  4.11508270e-02  3.10102422e-02  4.19706814e-02  4.11902852e-02
  4.15859930e-02 -1.29770339e-02 -3.46177677e-03  4.96111289e-02
 -2.47740350e-03  3.08873542e-02  8.14473182e-02  5.84357083e-02
 -1.34315155e-03  2.03145668e-02 -1.75586231e-02  6.01390749e-02
 -2.89171916e-02 -2.62065101e-02  4.90034632e-02 -4.61737029e-02
  2.96200570e-02  3.99897248e-02  1.70793198e-02 -2.99759865e-01
  3.20110396e-02  2.05208850e-03  2.56862398e-02 -1.51574342e-02
  2.31754035e-02  5.15095219e-02  3.41476612e-02 -8.13669860e-02
 -3.25243585e-02 -8.12758729e-02  1.85325649e-02  5.98889813e-02
  2.58031059e-02 -9.58902296e-03  1.94279626e-02  6.92547038e-02
 -6.79612979e-02  3.36275212e-02 -3.07035521e-02 -6.19131234e-03
  5.97523246e-03  1.97496548e-01 -4.07449715e-02  1.78925414e-02
  9.02287290e-03  1.40133584e-02  2.07171869e-02  4.25104685e-02
  1.94551665e-02  2.15721354e-02  2.09773947e-02  7.78526142e-02
 -4.00780551e-02  4.94649820e-02  7.53615350e-02 -5.19526675e-02
  2.71941386e-02  1.81595832e-02 -3.18458937e-02 -2.38540731e-02
  8.02989875e-04 -1.77396927e-02 -3.99905667e-02  4.19884883e-02
 -4.46297079e-02 -9.03795939e-03 -4.69500236e-02 -1.79911274e-02
 -8.20872374e-03 -2.24837158e-02  2.55275983e-02 -4.12117206e-02
 -2.00021500e-03  3.28872763e-02  3.63571756e-02 -2.87930947e-02
  8.20660405e-03 -1.44269420e-02 -3.23306359e-02  6.01105057e-02
 -1.13626815e-01  1.80635098e-02  2.21924037e-02  4.52287233e-04]",53
23856,8,2051.0,"```

For explanation purposes, we can also initialize the two main pipelines of Würstchen individually. Würstchen consists of 3 stages: Stage C, Stage B, Stage A. They all have different jobs and work only together. When generating text-conditional images, Stage C will first generate the latents in a very compressed latent space. This is what happens in the `prior_pipeline`. Afterwards, the generated latents will be passed to Stage B, which decompresses the latents into a bigger latent space of a VQGAN. These latents can then be decoded by Stage A, which is a VQGAN, into the pixel-space. Stage B & Stage A are both encapsulated in the `decoder_pipeline`. For more details, take a look at the [paper](https://huggingface.co/papers/2306.00637).

```python
import torch
from diffusers import WuerstchenDecoderPipeline, WuerstchenPriorPipeline
from diffusers.pipelines.wuerstchen import DEFAULT_STAGE_C_TIMESTEPS

device = ""cuda""
dtype = torch.float16
num_images_per_prompt = 2","[-5.07505462e-02 -9.73479729e-03  1.64412688e-02 -1.50459362e-02
  4.40333824e-04  3.15863676e-02 -2.99714593e-04 -3.43705341e-02
  9.95186158e-03 -2.05295030e-02  2.07369402e-03 -1.00476645e-01
  4.64699343e-02  6.57658651e-03 -3.15180682e-02  3.41260694e-02
  9.94640402e-03  1.07690422e-02 -3.77201885e-02 -2.14112457e-02
  5.97872585e-02 -3.29781957e-02  1.71745252e-02 -7.25580156e-02
  3.08147036e-02  1.68655999e-02 -1.69013813e-02 -2.45178584e-02
  2.96782842e-03 -2.58626699e-01  7.04914192e-03 -5.73348515e-02
  5.66455759e-02 -4.07884344e-02 -1.29227154e-02 -5.61022721e-02
 -1.25202266e-02  4.32524048e-02 -3.35488878e-02  4.47585471e-02
  4.84792851e-02  2.35963538e-02 -5.23755662e-02 -3.14673297e-02
 -2.24545226e-02 -1.05266817e-01  4.13151633e-04 -4.81289327e-02
 -2.90151350e-02 -2.86678113e-02  2.52353493e-02 -1.93009544e-02
  2.38964390e-02  2.16991343e-02  3.49333547e-02  2.00264268e-02
  5.56675531e-02  5.35199493e-02  1.35209579e-02  4.03878652e-02
  2.97315177e-02  2.37124152e-02 -1.98679715e-01  6.82143569e-02
  3.56771350e-02  1.60606187e-02 -1.98669303e-02 -4.23218720e-02
  6.30828589e-02  6.57949075e-02 -5.98568544e-02  9.46236495e-03
  2.62719467e-02  7.05543831e-02  4.12479567e-04 -7.77699873e-02
 -2.07311567e-03 -3.60904336e-02 -1.07671805e-02  1.42238624e-02
 -2.59538274e-03  2.21998543e-02 -3.00817788e-02  1.90026760e-02
 -4.06592600e-02 -3.79132368e-02  8.67020618e-03 -4.10113931e-02
 -1.79365277e-02 -9.53576248e-03 -6.31657615e-02 -7.78746605e-02
 -6.32692426e-02  5.36211692e-02 -5.39644882e-02 -4.73385751e-02
  5.44011220e-02  4.37704995e-02  2.25419272e-02  2.26706311e-01
 -4.26566340e-02 -6.01183297e-03  3.01336087e-02 -2.00067628e-02
  3.97089534e-02 -3.53979766e-02 -4.64439243e-02 -2.91870758e-02
 -3.62549089e-02  2.89182197e-02  1.83070265e-02 -5.16468659e-02
  6.12711385e-02 -4.81551103e-02  4.63758409e-02 -2.61830864e-03
  5.61466860e-03  4.40206863e-02 -1.61910057e-02  1.13490624e-02
 -4.95152548e-02  3.28515209e-02  8.52726400e-04 -8.67949566e-05
 -1.58305597e-02 -2.89658946e-03  5.93973137e-02  8.25415403e-02
  1.49539635e-02  3.14955115e-02  3.74114104e-02 -2.08438504e-02
 -1.94296595e-02  1.08761769e-02 -4.65803854e-02  4.17576022e-02
  7.06933485e-03  2.68577896e-02  1.85342580e-02 -1.96954422e-02
  4.78882017e-03 -7.01229274e-02 -1.56581439e-02 -7.06361011e-02
 -5.35256648e-03  1.10911816e-01 -3.03482451e-02  7.37696737e-02
 -2.28792578e-02 -4.36726632e-03  4.38861735e-03  3.56559530e-02
 -1.84399206e-02  1.50082796e-03  3.98220029e-03  2.18885485e-02
  4.66446951e-03  6.03968017e-02 -2.59055849e-02  1.86496824e-02
 -2.99310740e-02 -5.48391379e-02 -8.01618695e-02  7.01161996e-02
  1.30726583e-02 -8.18304643e-02 -9.15475562e-03  9.48964094e-04
  1.75992101e-02 -1.93005707e-02  9.41091031e-03  5.17917611e-03
 -1.00523839e-02  1.62009243e-02  8.54240358e-03  4.37725894e-03
 -5.84419817e-02  1.31625962e-02  1.61630586e-02  2.25285571e-02
  4.01198342e-02 -2.02686414e-02  2.53409054e-02  1.90890599e-02
  2.38645840e-02 -8.23164135e-02  2.13570446e-02 -2.03892495e-02
 -1.14186294e-02  5.13039753e-02 -1.10522546e-02  5.01804315e-02
 -2.73647308e-02 -2.82139666e-02 -1.56596862e-02 -1.85975432e-02
 -3.64253409e-02 -2.12200060e-02 -4.49170806e-02 -4.41056415e-02
  6.04304597e-02  5.75144850e-02 -2.83335000e-02  2.75161769e-02
 -2.83876527e-02 -1.94135550e-02 -1.30430032e-02 -1.92824677e-02
  8.23719352e-02  1.10470401e-02 -3.00040077e-02 -1.72411222e-02
  4.66573983e-02 -1.26664340e-02 -7.65500730e-03 -2.08221693e-02
  7.45344814e-03  2.82712858e-02 -1.11142835e-02  4.38376889e-02
  3.41370213e-03 -4.34137359e-02 -6.18909560e-02 -2.62269974e-01
  2.55518723e-02  2.51461323e-02 -5.15696555e-02  6.22085482e-02
 -5.38320206e-02  1.00404294e-02  1.98584143e-02  5.42829419e-03
  4.83135507e-02  8.59309807e-02  3.10721598e-03  1.14454124e-02
  2.00859439e-02 -2.55489498e-02  4.62513156e-02  7.96225388e-03
  4.12261784e-02 -5.95860975e-03 -4.02709236e-03 -2.49417331e-02
 -1.54432543e-02 -1.63079966e-02 -1.11322813e-01  2.88257264e-02
 -2.93549262e-02  2.40611255e-01  5.45621552e-02  5.51595353e-02
 -2.88014691e-02  7.79696181e-02 -1.81052014e-02 -4.74025607e-02
 -9.07124728e-02  4.33459207e-02  3.92110646e-02  6.26634434e-02
 -2.58684102e-02  2.23083291e-02  1.75643303e-02 -8.86411930e-04
  2.87456065e-02  2.44404078e-02 -8.00439790e-02  2.41040345e-02
 -2.80706231e-02 -5.64550683e-02  4.36475351e-02 -3.14367637e-02
 -1.35752829e-02  4.62863892e-02 -3.45755108e-02  3.77233438e-02
  2.74484921e-02  7.51591101e-03 -4.85572964e-02 -7.31811374e-02
 -3.93939298e-03 -2.89846212e-02  2.12432053e-02 -1.05638104e-02
 -2.41754875e-02 -1.17685320e-02 -3.80052179e-02  4.72054183e-02
 -1.19866105e-03  3.25183547e-03 -6.16459362e-02  4.06804606e-02
 -2.75121350e-02 -3.09462231e-02  9.44935232e-02 -1.77185107e-02
  1.36789624e-02  3.23545970e-02  3.66438590e-02  1.73245706e-02
 -2.50674295e-03 -1.77539848e-02  1.01589849e-02  4.65660207e-02
 -4.41874936e-02  4.56070388e-03  4.31904756e-02  1.34196104e-02
 -9.31416266e-03  3.69018354e-02  2.06880309e-02  3.53525355e-02
  8.15724861e-03 -2.03000288e-02  3.03556025e-02 -5.18436581e-02
  1.17571978e-02  2.11546626e-02  3.50279897e-03 -3.07959706e-01
  2.69939918e-02  2.96676531e-02 -2.62944158e-02 -2.63577979e-03
  1.78779531e-02  4.63326834e-02  2.86582522e-02 -4.08094935e-02
 -3.08766551e-02 -3.14761177e-02  5.59854358e-02  3.99317518e-02
  1.27441967e-02  1.70427896e-02  4.85281013e-02  1.07585542e-01
 -7.25550801e-02  1.48684280e-02 -4.17668596e-02  7.48168270e-04
  6.17709057e-03  2.09268376e-01 -2.90845130e-02  3.02829444e-02
 -2.05006879e-02 -1.08812721e-02  3.45289111e-02  4.27520350e-02
  2.28299368e-02  8.08483958e-02  3.93931642e-02  9.16756615e-02
 -3.60830165e-02  7.39700198e-02  8.93305466e-02 -5.27457371e-02
  4.49213907e-02  1.98421292e-02 -2.74458490e-02 -4.21348736e-02
  3.57620455e-02 -5.32346219e-02 -6.85326308e-02  8.01042840e-02
 -1.50291789e-02  4.87546623e-03 -6.75188377e-02 -1.99606866e-02
 -9.28255264e-03 -1.25315860e-02  1.52574088e-02 -3.66614051e-02
  1.55850640e-02  3.19650173e-02  2.21546995e-03  7.16795679e-04
 -1.36659881e-02 -6.08309265e-03 -2.13210285e-02  3.05295996e-02
 -7.98482820e-02  3.14443745e-02  2.41874829e-02  1.86101608e-02]",53
10455,26,884.0,"```

### 1.6 Stage 3: Super Resolution 256x256 to 1024x1024

The second super resolution model for IF is the previously release
[Stability AI\'s x4
Upscaler](https://huggingface.co/stabilityai/stable-diffusion-x4-upscaler).

Let\'s create the pipeline and load it directly on GPU with
`device_map=""auto""`.

``` python
pipe = DiffusionPipeline.from_pretrained(
    ""stabilityai/stable-diffusion-x4-upscaler"", 
    torch_dtype=torch.float16, 
    device_map=""auto""
)","[-3.49091031e-02 -1.63070876e-02  3.43278348e-02 -1.70503575e-02
  2.97587197e-02  1.54376924e-02 -5.81282228e-02  9.50236525e-03
  6.81846170e-03  2.42908150e-02  1.78803485e-02 -1.21088952e-01
  7.28860423e-02  4.39265231e-03 -3.50802727e-02  3.30512598e-02
  1.32420589e-03 -2.44062277e-03 -4.94481288e-02  3.04450169e-02
  5.71842715e-02 -1.14802066e-02  1.22289611e-02 -7.59409219e-02
  1.66857745e-02  3.58878337e-02 -3.16380374e-02 -4.61799614e-02
 -3.07269697e-03 -2.59981960e-01 -3.85659696e-05 -4.33161743e-02
  4.51148972e-02 -1.71306133e-02 -2.98103807e-03 -4.71105985e-02
 -3.46869454e-02  5.92206940e-02 -9.44352522e-03  4.47582155e-02
  2.39054319e-02  5.02022393e-02  8.39828234e-03 -3.36851217e-02
 -1.62924174e-02 -4.43793908e-02 -5.55257984e-02 -1.42236548e-02
  3.97610525e-03 -5.31488955e-02  1.69598330e-02 -1.33080585e-02
 -9.61294957e-03  3.39217298e-02 -5.78082725e-03  2.43830010e-02
  3.81907709e-02  2.83005610e-02  4.88189124e-02  6.28177356e-03
  1.83135420e-02  6.10935315e-02 -2.15269417e-01  5.55884279e-02
  4.11602706e-02  2.56437063e-02 -3.75168547e-02 -5.61058931e-02
  2.71830931e-02  5.17503098e-02 -6.19305260e-02  3.49794216e-02
  2.34339405e-02  2.72115320e-02 -8.03709961e-03 -6.87924325e-02
  2.32284795e-02 -1.66965034e-02  3.78164537e-02  3.29941027e-02
  2.73971818e-02  9.57500562e-03 -2.30736341e-02 -2.83185989e-02
 -1.94081813e-02 -3.38955000e-02  2.40792278e-02 -9.74852778e-03
  4.24078219e-02 -4.16513858e-03 -6.04319535e-02 -1.06634144e-02
 -4.16905098e-02  6.38205335e-02 -8.95278826e-02 -2.04824004e-02
  4.84774336e-02 -1.23920636e-02  1.27088884e-02  2.14164436e-01
 -5.03645372e-03 -1.56130316e-02  3.17563117e-02  1.29334517e-02
  2.79605184e-02 -1.67383123e-02 -2.71904897e-02  2.23416984e-02
 -6.74335882e-02 -1.28085576e-02 -1.14972685e-02 -5.99017404e-02
  8.84374976e-02 -8.80539790e-03  5.94232269e-02 -1.42542645e-02
 -1.07131619e-02  4.21317155e-03 -1.19347870e-02  1.15439668e-02
  5.60713047e-03  2.85127573e-02  6.16566576e-02 -4.08214703e-02
  1.82680991e-02  1.14514483e-02  4.87388410e-02  9.14250761e-02
 -1.89964082e-02  7.91367330e-03  2.05801260e-02 -3.50823365e-02
 -8.78576469e-03  1.77335236e-02 -1.81962196e-02  2.17655040e-02
  1.71790980e-02  1.34245271e-03  1.92752574e-02 -1.48119321e-02
 -2.05747690e-02 -6.65614977e-02 -7.58724893e-03 -8.64743739e-02
 -2.76041459e-02  1.25275135e-01 -4.00808081e-02  7.58312717e-02
 -4.67443801e-02 -2.20018476e-02  1.22458264e-02  3.55872661e-02
 -2.77994350e-02 -1.02878539e-02  2.21001487e-02  6.46473169e-02
 -4.25635837e-03  5.84834479e-02 -7.30650648e-02  3.75750549e-02
 -2.36603264e-02 -8.55959132e-02 -6.84319660e-02  9.87656340e-02
  3.18525992e-02 -6.40177950e-02 -1.88233554e-02 -1.78287213e-03
 -1.31696248e-02  4.79513733e-03  1.52701410e-02 -5.36189787e-03
 -3.80578153e-02  2.07512174e-02  5.18624373e-02  6.52244501e-03
 -7.32676238e-02 -4.46343981e-03  1.37821045e-02  1.84794236e-02
  5.07001989e-02 -2.75518820e-02 -3.99608985e-02 -7.77871720e-03
  1.93715189e-02 -8.03398564e-02 -1.42017668e-02 -2.89410800e-02
  1.88726429e-02  4.63865651e-03 -5.55594452e-02  4.71865460e-02
 -6.96460009e-02 -6.72190487e-02  1.45888180e-02 -2.34175958e-02
 -2.85881422e-02 -1.64658688e-02 -1.35693466e-02 -8.63972772e-03
  5.85106350e-02  5.53795211e-02 -3.51000912e-02  9.25349258e-03
 -3.08255292e-02  1.43284556e-02 -2.67911088e-02 -1.28019508e-02
  1.51377432e-02  3.63619588e-02 -6.83627352e-02 -3.51595953e-02
  8.09850767e-02  4.33545746e-03 -4.13737074e-02  1.07155889e-02
  2.27099378e-03 -2.59200782e-02 -7.44944299e-03  4.89488244e-02
  6.53805286e-02 -3.95238362e-02 -7.91212842e-02 -2.31372029e-01
  2.24466585e-02  1.56541429e-02 -1.65178761e-04  7.13768452e-02
 -3.57704312e-02  6.86031953e-02 -2.17710007e-02  5.07640913e-02
  6.04324006e-02  6.53637722e-02 -2.16204897e-02  6.41120672e-02
  2.51905750e-02 -1.74531844e-02  2.69024279e-02 -6.42651785e-03
  2.06717812e-02 -4.66289110e-02 -2.69936882e-02 -2.80897077e-02
  1.80828162e-02 -4.95010428e-02 -5.38929105e-02  4.30295058e-02
 -3.64468209e-02  2.54752308e-01  2.11469717e-02  2.51978710e-02
  1.31669897e-03  5.70356287e-02  2.39525083e-02 -7.70213827e-02
 -7.17327148e-02  3.66002880e-02  4.35172021e-02  5.12819625e-02
  2.53526866e-02 -5.10616563e-02 -1.54946642e-02 -2.41137147e-02
  4.20521796e-02  1.88323427e-02 -1.02784008e-01 -2.82856859e-02
  5.27944462e-03 -2.87441295e-02  6.26648366e-02 -3.85279432e-02
  3.47904228e-02  3.08023449e-02  1.22249192e-02  8.91942158e-03
 -1.99921932e-02  5.58317685e-03 -3.77281904e-02 -9.87315997e-02
  1.92188099e-02 -1.36553599e-02 -1.49492333e-02 -1.03335129e-02
 -5.16120419e-02 -3.25584933e-02 -1.80759449e-02  7.58317858e-02
  2.31345790e-03  1.49183106e-02 -3.06312256e-02  1.33631537e-02
 -4.28748354e-02  4.29890305e-02  4.91400734e-02 -1.78283639e-02
  2.48721503e-02  5.00970185e-02  3.29872668e-02  3.36240157e-02
  7.37761287e-03 -2.19172072e-02 -2.26348362e-04  4.83651273e-02
 -2.96758004e-02  5.53473756e-02  4.07028832e-02  3.37287746e-02
  2.05526520e-02  2.05371659e-02 -7.24546751e-03  2.64034830e-02
 -6.73382729e-03 -2.67649273e-04  1.77608095e-02 -4.89814058e-02
 -2.78438795e-02  3.09846289e-02 -1.88975763e-02 -3.05660307e-01
  2.69663334e-02  5.41137271e-02  6.76792813e-03 -2.15275194e-02
 -9.16876085e-03  4.26271297e-02  4.92813028e-02 -7.62362555e-02
 -3.40813160e-04 -7.85099342e-02  3.94098982e-02  6.02129251e-02
  6.29234016e-02 -1.37524568e-02  1.59608405e-02  9.04363543e-02
 -7.26771057e-02  4.16404977e-02 -8.07046816e-02 -1.30189061e-02
  4.38066497e-02  1.86280817e-01 -2.40008086e-02  1.40947849e-02
  2.18567997e-02  1.19235525e-02  1.05752787e-02  1.44092040e-02
 -2.42939070e-02 -1.00202579e-02  2.14774739e-02  1.88426320e-02
 -3.13785151e-02  3.72146964e-02  8.56923983e-02 -6.71674833e-02
  2.18679663e-02  3.66213098e-02  7.12726777e-03  3.11435224e-03
  2.76189093e-02 -3.76248844e-02 -2.47369446e-02  1.00703530e-01
 -1.77083369e-02  5.89331705e-03  2.69311597e-03 -1.69640454e-03
 -1.85571648e-02 -1.13998409e-02  7.38519360e-04  1.12830903e-02
  1.25427200e-02  6.41462654e-02  2.94235423e-02 -3.22889984e-02
 -1.54516129e-02 -5.04986085e-02 -2.27594282e-02 -1.67251267e-02
 -5.57124354e-02 -1.28819179e-02  1.73536260e-02  3.79135506e-03]",53
25935,71,2233.0,"```python
import requests
from PIL import Image
from io import BytesIO
import torch
import os
from diffusers import DiffusionPipeline, DDIMScheduler
has_cuda = torch.cuda.is_available()
device = torch.device('cpu' if not has_cuda else 'cuda')
pipe = DiffusionPipeline.from_pretrained(
    ""CompVis/stable-diffusion-v1-4"",
        safety_checker=None,
    custom_pipeline=""imagic_stable_diffusion"",
    scheduler = DDIMScheduler(beta_start=0.00085, beta_end=0.012, beta_schedule=""scaled_linear"", clip_sample=False, set_alpha_to_one=False)
).to(device)
generator = torch.Generator(""cuda"").manual_seed(0)
seed = 0
prompt = ""A photo of Barack Obama smiling with a big grin""
url = 'https://www.dropbox.com/s/6tlwzr73jd1r9yk/obama.png?dl=1'
response = requests.get(url)
init_image = Image.open(BytesIO(response.content)).convert(""RGB"")
init_image = init_image.resize((512, 512))
res = pipe.train(
    prompt,
    image=init_image,
    generator=generator)","[-6.21874072e-02 -1.39972428e-02  1.35237072e-03 -9.33239143e-03
  2.20885817e-02  6.68287370e-03  1.09744421e-03 -3.34852189e-02
 -1.99311934e-02  3.91522348e-02  6.05855370e-03 -9.53233168e-02
  5.93561456e-02  2.70646345e-02 -3.50086465e-02  3.74445543e-02
  2.14414634e-02 -1.71471760e-02 -4.20183428e-02  1.33864032e-02
  4.11361791e-02 -1.86701510e-02 -3.43020656e-03 -1.02065168e-01
  1.68355349e-02 -2.52182921e-03 -1.01954220e-02 -4.64349519e-03
 -4.54966724e-02 -1.99488342e-01  3.23320292e-02 -7.27556795e-02
  2.39938647e-02 -6.10575825e-02  1.52898338e-02 -3.51043567e-02
 -1.38992807e-02  3.46049033e-02 -2.34052781e-02  6.93772361e-02
  9.88261122e-03 -1.75627396e-02 -5.44667915e-02 -1.25715863e-02
 -3.38962823e-02 -8.07367042e-02 -5.33198602e-02 -2.83748601e-02
  4.64561321e-02 -3.45425121e-02  2.03410201e-02 -8.89470428e-03
  1.26837501e-02  8.16133805e-03  2.00140965e-03  1.85527571e-03
  6.41198605e-02  3.05553768e-02  6.13971315e-02  3.77943181e-02
  1.19878759e-03  5.86702302e-02 -2.10294932e-01  9.54137295e-02
  2.37565506e-02  2.33266819e-02 -2.93931570e-02 -3.58625725e-02
  1.57747809e-02  2.82107703e-02 -3.79428677e-02  4.33012098e-02
  3.19533423e-02  4.55375649e-02 -2.78885737e-02 -7.88849890e-02
 -8.88126087e-05 -1.01930099e-02 -4.17830655e-03  1.95881277e-02
 -2.65091639e-02 -4.23393538e-03 -1.64978916e-03 -3.21331955e-02
  1.13498364e-02 -1.44950179e-02  2.94017494e-02 -4.65642698e-02
  4.31245305e-02  6.46175991e-04 -7.28252530e-02 -5.76328561e-02
 -1.93308908e-02  4.04560640e-02 -5.44702336e-02  5.94892190e-04
  5.03308699e-02  3.94728594e-03 -4.91997302e-02  2.12684989e-01
 -6.76055849e-02  1.43862423e-02  3.51879373e-02  2.14376915e-02
  2.07934827e-02 -8.53552297e-03 -2.85833748e-03 -3.01967561e-02
 -4.59449738e-02 -2.01659035e-02  6.03497215e-03 -4.82458621e-02
  6.05347343e-02 -4.14125770e-02  3.50974873e-02 -1.97007973e-02
 -3.49247828e-02 -1.23848794e-02 -3.70949693e-02  1.92589208e-03
 -9.16126091e-03 -1.46408901e-02  4.02308814e-02 -1.11123929e-02
  1.50753157e-02 -1.27357570e-02  6.40720278e-02  1.23987906e-01
  6.22098986e-03  5.04957773e-02  6.22336231e-02  7.19589822e-04
 -3.33668813e-02 -5.26810344e-03 -2.13730056e-03  5.42469211e-02
  1.77369583e-02 -3.70455198e-02  1.95714878e-03 -1.87109672e-02
 -2.90407017e-02 -1.04990795e-01 -2.20641512e-02 -7.70136043e-02
 -4.33128374e-03  9.31469277e-02 -3.76711190e-02  1.00527301e-01
 -3.05557456e-02 -3.92529219e-02 -1.12893386e-02  2.62781214e-02
 -1.99502166e-02 -8.30611214e-03  3.99632901e-02  4.10593934e-02
  1.12574548e-02  9.90398675e-02 -3.80521864e-02  2.94691902e-02
 -1.32799512e-02 -9.55125093e-02 -2.23463457e-02  1.00344338e-01
  4.95266682e-03 -1.01560526e-01 -1.68147963e-02 -2.50246469e-02
 -6.24956423e-03 -1.98070612e-02  3.41251306e-02  7.84678850e-03
 -4.60429303e-02 -3.23621812e-03  5.83415367e-02  3.45953628e-02
 -3.17931026e-02 -9.20330361e-03  2.81051770e-02  1.40479878e-02
  3.53854746e-02 -3.84760350e-02 -5.31166000e-03  1.38971545e-02
  2.23779790e-02 -4.06812765e-02 -5.16673131e-03 -4.42258306e-02
  2.53643263e-02  8.73337090e-02 -3.04088406e-02  3.52619700e-02
 -2.06952468e-02 -5.89282662e-02 -3.64258662e-02 -4.05277200e-02
 -3.14027555e-02 -4.65021916e-02 -9.17906966e-03 -2.74359696e-02
  5.51895462e-02  1.02449991e-02 -2.46792678e-02  8.70821904e-03
 -1.77244972e-02  3.08433399e-02 -2.43110396e-02 -2.22726148e-02
  5.04584685e-02  1.57460012e-02 -7.04355538e-02 -3.96000072e-02
  5.63425831e-02  1.48852682e-03 -5.79249896e-02 -1.47699397e-02
  1.11000352e-02  2.37066168e-02  2.42081434e-02  3.71648818e-02
  1.48228258e-02 -3.40089500e-02 -7.50929639e-02 -2.54072070e-01
  2.66851541e-02  3.79007347e-02  3.94156761e-03  4.63867225e-02
 -5.84067442e-02  6.57510310e-02 -2.63778996e-02  2.30821427e-02
  1.02653466e-01  1.21547796e-01 -1.96644850e-02  5.55859990e-02
 -2.73942575e-02 -2.58183852e-02  1.73104294e-02  1.55819571e-02
  1.38010858e-02 -4.86404728e-03  1.78899840e-02 -1.06670186e-02
 -1.18440585e-02  6.51507126e-03 -8.73299092e-02  5.31933233e-02
 -5.80523387e-02  2.09941030e-01  1.70730948e-02  9.41085722e-03
 -3.79458163e-03  6.61605820e-02  3.44148576e-02 -1.97257251e-02
 -1.44235715e-01  4.83949296e-02  6.65297285e-02  2.48786025e-02
  2.00325921e-02 -3.30031896e-03  7.07271975e-03 -3.60302534e-03
  6.29011840e-02 -2.41318550e-02 -6.09290227e-02  1.14301303e-02
 -2.81709451e-02  1.05669699e-03  3.66932079e-02 -6.13266118e-02
  3.65228131e-02  8.33090171e-02 -3.45654450e-02  2.66654436e-02
  2.24684328e-02  5.84595464e-03 -4.59169447e-02 -6.03795014e-02
  3.04144770e-02 -2.04254705e-02  1.64472554e-02 -2.11373456e-02
 -6.60615787e-02  1.89122371e-02 -1.61266550e-02  3.59888896e-02
  5.21372398e-03  6.82325382e-03 -2.06341408e-02  4.32498828e-02
 -1.03880931e-02  1.60702989e-02  8.62569064e-02 -1.84545889e-02
  4.03099731e-02  3.94763425e-02  3.83611545e-02  2.68401522e-02
  1.17139537e-02  1.24988351e-02 -6.97132433e-03  2.53231302e-02
 -2.04073098e-02  3.74778248e-02  7.42126256e-02  3.23150977e-02
 -7.24843645e-04  2.88071446e-02  3.95151135e-03  6.94715753e-02
 -1.87007412e-02  9.35172942e-03  1.64442062e-02 -2.13031583e-02
  2.06178967e-02  2.55551171e-02  1.53671661e-02 -3.14455509e-01
  3.49992700e-02 -6.42946223e-03  4.72280085e-02  1.42712872e-02
  3.37012038e-02  6.40415847e-02  3.56605500e-02 -8.45299810e-02
 -2.12254953e-02 -7.73099065e-02  1.00879110e-02  4.05586362e-02
  2.88329814e-02  3.51671083e-03  3.92452516e-02  3.80726978e-02
 -6.21447340e-02  2.37470791e-02 -2.77438443e-02 -3.15776467e-03
  2.57817768e-02  1.84154257e-01 -7.33570233e-02 -1.12772989e-03
  3.12167145e-02 -1.58657804e-02  1.06994463e-02  4.12162058e-02
 -1.82884722e-03  4.24296856e-02 -8.93384498e-03  6.61519021e-02
 -5.35187274e-02  6.78305030e-02  4.48626839e-02 -7.78409019e-02
  5.12564406e-02  2.36764364e-03 -5.05589657e-02 -5.59394918e-02
  3.01007763e-03 -9.30211134e-03 -4.37644273e-02  5.67742698e-02
 -4.36137579e-02 -8.06708541e-03 -5.09547591e-02  1.39202140e-02
  2.41916608e-02 -9.56174452e-03 -2.91584572e-03 -1.32842865e-02
  6.81936648e-03  3.54888439e-02  3.75251435e-02 -1.65666118e-02
  9.91709251e-03 -3.17545347e-02 -1.19631644e-02  4.72734608e-02
 -9.08452198e-02  3.27550545e-02  1.39917750e-02 -5.76387020e-03]",53
19424,5,1631.0,"## Image-to-image

LCMs can be applied to image-to-image tasks too. For this example, we'll use the [LCM_Dreamshaper_v7](https://huggingface.co/SimianLuo/LCM_Dreamshaper_v7) model, but the same steps can be applied to other LCM models as well.

```python
import torch
from diffusers import AutoPipelineForImage2Image, UNet2DConditionModel, LCMScheduler
from diffusers.utils import make_image_grid, load_image

unet = UNet2DConditionModel.from_pretrained(
    ""SimianLuo/LCM_Dreamshaper_v7"",
    subfolder=""unet"",
    torch_dtype=torch.float16,
)

pipe = AutoPipelineForImage2Image.from_pretrained(
    ""Lykon/dreamshaper-7"",
    unet=unet,
    torch_dtype=torch.float16,
    variant=""fp16"",
).to(""cuda"")
pipe.scheduler = LCMScheduler.from_config(pipe.scheduler.config)","[-1.08377272e-02 -2.21865792e-02  2.88243163e-02  1.32515635e-02
 -1.59041137e-02  2.90226322e-02  1.03330156e-02  7.48990336e-03
 -1.94860958e-02  1.96282640e-02  9.11976956e-03 -1.04601994e-01
  2.29586381e-02  5.77094890e-02  1.29520306e-02 -3.39482445e-03
 -6.97462400e-03  5.13647795e-02 -3.29843238e-02 -4.69277054e-03
  9.47530940e-03 -2.56109424e-02 -6.36014715e-03 -3.10354158e-02
 -2.03328513e-04  1.02581773e-02 -3.23681384e-02 -8.37347563e-03
 -4.77138869e-02 -2.36498952e-01  1.03452131e-02 -5.22106923e-02
  3.62535566e-02 -5.14054373e-02  2.50484943e-02 -2.69035678e-02
 -5.24650849e-02  4.77628633e-02 -8.65614638e-02  1.63913183e-02
  2.69068591e-02  1.21628018e-02 -5.44347018e-02 -5.11703938e-02
 -2.70424318e-02 -6.01288453e-02 -2.50831060e-02 -1.04662906e-02
  1.45644285e-02 -1.61933433e-02  2.05845349e-02 -2.94336751e-02
  1.79910697e-02 -4.62999707e-03 -1.16944527e-02  5.89200258e-02
  4.88207154e-02  2.35499516e-02  7.13514164e-02  3.02499551e-02
  2.64317100e-03  6.21138811e-02 -1.94389671e-01  7.89144561e-02
  2.00372003e-03  1.95509885e-02 -1.52473776e-02 -2.77161505e-02
  2.68087238e-02  6.68048486e-02 -7.76594281e-02  3.73891816e-02
  5.68350917e-03  4.56131622e-02  2.74008233e-02 -5.86853996e-02
 -2.64505413e-03 -3.97416726e-02 -4.63643186e-02 -5.32210013e-03
 -5.44009730e-03  4.57509537e-04 -3.58833419e-03 -1.74583811e-02
  3.10557391e-02  4.73821424e-02  1.02739790e-02 -6.35476261e-02
  5.60041443e-02 -1.66319273e-02 -3.63015682e-02 -6.43299296e-02
 -5.47667071e-02  4.16568741e-02 -1.08248599e-01 -2.89936904e-02
  6.03910275e-02  1.88446306e-02 -1.28013622e-02  2.15087101e-01
 -6.13735765e-02  5.87225053e-03  4.34095748e-02 -1.60163548e-02
  4.21133898e-02 -1.00474283e-02 -2.21026372e-02 -3.13061252e-02
 -4.86562289e-02 -3.45692560e-02  1.71967614e-02  9.57065355e-03
  4.60111313e-02 -1.42440656e-02  5.00310911e-03 -5.55597339e-03
  2.00191271e-02  1.10171437e-02 -1.32915173e-02  3.43287587e-02
 -3.63464169e-02  3.08755413e-02  1.91163477e-02 -1.81068182e-02
  1.90551393e-02 -2.53788028e-02  6.18426651e-02  9.57843661e-02
  6.23816252e-02  2.69926824e-02  3.50377858e-02 -2.52594128e-02
 -3.52890864e-02 -1.91153120e-02  1.91182829e-02  6.36612549e-02
  5.66038191e-02 -4.17015180e-02  1.25127686e-02 -2.12533469e-03
 -4.31215100e-04 -6.73005655e-02  9.79010575e-03 -6.57118335e-02
 -6.17081358e-04  1.25039816e-01 -3.54012623e-02  6.65998906e-02
 -6.79794326e-02 -1.41101722e-02  1.76340565e-02  3.47889550e-02
 -2.35567689e-02  1.39820147e-02  3.11598852e-02  2.48450320e-02
  5.13951741e-02  9.71183479e-02 -4.45365757e-02  2.06849799e-02
 -2.40868274e-02 -7.12545887e-02 -3.51673327e-02  8.71997699e-02
 -3.47456033e-03 -6.74197450e-02 -8.11125268e-04 -3.65820564e-02
 -1.47897657e-02 -2.29318067e-02  7.05556059e-03  1.11549832e-02
 -4.16383781e-02 -3.07138301e-02  5.43689206e-02  5.11185154e-02
 -6.21393248e-02 -1.08780246e-03 -1.29716704e-02  2.86810417e-02
  2.41413862e-02 -5.26177622e-02  2.89515802e-03  8.46478064e-03
 -3.00261099e-02 -5.15770540e-02 -2.93031894e-02 -3.74691449e-02
  1.60508673e-03  2.92187706e-02 -3.59423980e-02  6.96448311e-02
  2.24716943e-02 -2.79904287e-02 -4.95848693e-02 -2.11695954e-02
 -3.83894816e-02 -4.37116586e-02  1.00398259e-02 -4.09128331e-02
  1.77454911e-02  3.80126052e-02 -2.44616307e-02  1.61507800e-02
 -2.25740634e-02  6.52920827e-03 -4.92928401e-02 -3.03337462e-02
  6.92752898e-02  3.16303261e-02 -7.66435117e-02 -2.26585884e-02
  7.57628009e-02  1.04297348e-03 -5.87825142e-02  2.74625868e-02
  3.37227397e-02  3.22380736e-02  3.57209109e-02  3.21176276e-02
  2.38520056e-02 -3.37008722e-02 -2.93852314e-02 -2.77605832e-01
  4.23325188e-02  3.26581672e-02 -1.42236650e-02  4.85966690e-02
 -4.20269519e-02  6.76956447e-03 -1.12025514e-02 -1.34049158e-03
  4.86336350e-02  1.03038996e-01 -3.56646925e-02  1.97237171e-03
  1.25794364e-02 -2.12236606e-02 -4.78841737e-03 -4.30357456e-03
  1.42286485e-02 -3.70866247e-02 -1.25330538e-02  8.96765909e-04
 -1.84715085e-03  3.78441736e-02 -1.02679566e-01  2.78322306e-02
 -2.92295478e-02  2.35126495e-01  1.47814984e-02 -1.43739907e-02
 -1.15033975e-02  3.92336883e-02  2.74690613e-02 -5.16299270e-02
 -9.80620086e-02  6.42610528e-03 -2.80798692e-02  3.23840193e-02
 -5.11546037e-04  4.06788699e-02  4.73005930e-03 -3.51329781e-02
  3.50027010e-02  6.29094336e-03 -1.11858591e-01 -3.02949101e-02
 -1.50471213e-04 -1.10840769e-02  3.44271250e-02 -5.62184937e-02
 -1.03605203e-02  2.38444209e-02 -3.52082439e-02  1.85067989e-02
 -1.79848317e-02 -7.20310444e-03 -3.31409648e-02 -8.38932395e-02
  3.59175876e-02 -3.69395465e-02  2.97959652e-02  5.39737567e-03
 -3.13406512e-02  1.81220006e-02 -6.76188767e-02  6.59217238e-02
 -3.82156223e-02 -4.19794768e-03 -5.42765073e-02  4.02695388e-02
  2.58756150e-03  1.63865630e-02  9.59620923e-02  1.01941852e-02
  5.66306263e-02  6.10249229e-02  3.52321006e-02 -2.63968129e-02
  9.30936169e-03 -2.30807867e-02  1.95674691e-03  5.63923046e-02
 -2.05194224e-02  1.67471878e-02  4.84124757e-02  4.24001366e-02
  3.37985903e-02 -1.85122411e-03  3.35765467e-03  5.18048462e-03
 -6.77558873e-03 -3.37209851e-02 -7.51619413e-03 -3.35235819e-02
  5.86672081e-03  3.18867527e-02  1.22147854e-02 -3.02148461e-01
  3.06745991e-02  2.23767683e-02  5.70710041e-02 -4.40321397e-03
  2.05783080e-02  2.37770844e-02  4.82541621e-02 -8.06312487e-02
  3.53000965e-03 -4.62552011e-02  1.92376170e-02  5.31896167e-02
  3.40465792e-02 -6.33834815e-03  5.54098636e-02  4.72484417e-02
 -4.91271205e-02  6.51641861e-02 -6.20738082e-02 -2.50234883e-02
  1.06481258e-02  2.31918857e-01 -2.92724296e-02  3.79664684e-03
  4.66622338e-02 -8.43863469e-04  1.88739933e-02  3.77205238e-02
  4.56011072e-02  5.34165874e-02  3.46511230e-02  7.26453140e-02
 -2.38165818e-02  6.46755621e-02  6.90758675e-02 -4.17582318e-02
  4.54619639e-02  1.08102837e-03 -1.19805103e-02 -3.39723155e-02
  5.45783602e-02 -2.93805953e-02 -3.20604742e-02  6.43391311e-02
 -3.74831334e-02  1.53822210e-02 -1.87452734e-02  6.33910182e-04
 -7.07076676e-03 -3.25701013e-02  1.09672279e-03 -1.42126195e-02
  6.08845288e-03  2.47922223e-02  5.74404597e-02 -4.04912829e-02
  1.73741404e-03 -2.41451655e-02 -1.18564824e-02  5.88818900e-02
 -6.64108172e-02 -2.44105957e-03  8.35325848e-03 -1.77819325e-04]",53
25944,80,2233.0,"init_image = PIL.Image.open(image_path).convert(""RGB"").resize((512, 512))
inner_image = PIL.Image.open(inner_image_path).convert(""RGBA"").resize((512, 512))
mask_image = PIL.Image.open(mask_path).convert(""RGB"").resize((512, 512))

pipe = DiffusionPipeline.from_pretrained(
    ""runwayml/stable-diffusion-inpainting"",
    custom_pipeline=""img2img_inpainting"",

    torch_dtype=torch.float16
)
pipe = pipe.to(""cuda"")

prompt = ""Your prompt here!""
image = pipe(prompt=prompt, image=init_image, inner_image=inner_image, mask_image=mask_image).images[0]","[-9.94215999e-03 -3.91110331e-02  4.90182545e-03 -2.61403657e-02
  3.82074411e-03  4.13178019e-02  2.47544702e-02 -4.21468401e-03
  8.92568938e-03  1.48592684e-02  5.59737999e-03 -1.12746462e-01
  4.18811515e-02  2.53886562e-02 -1.89824775e-02  4.04426865e-02
 -1.41877588e-02  1.58368051e-02 -6.10817634e-02  4.35659691e-04
  3.90635468e-02 -1.75472125e-02 -3.09723034e-03 -8.83440524e-02
  2.38172822e-02 -1.17270984e-02 -1.83039475e-02 -2.18204204e-02
 -1.77803040e-02 -2.19945371e-01  2.65368465e-02 -3.84810716e-02
  3.62732969e-02 -6.44806847e-02  1.27618099e-02 -3.06155384e-02
 -3.94273698e-02  6.60519749e-02 -1.88600458e-02  3.96970026e-02
  3.58412787e-02  1.15590822e-02 -6.84487820e-02 -3.45995054e-02
 -3.52324210e-02 -7.30129778e-02 -4.34408411e-02 -2.20070966e-02
  5.68828620e-02 -3.59475538e-02  1.73603185e-02 -2.37164702e-02
 -2.90260222e-02  2.95941886e-02  5.29165007e-03  2.72523649e-02
  6.45536482e-02  3.73729505e-02  9.09694806e-02  2.11777333e-02
  2.01597735e-02  6.57736957e-02 -2.04231396e-01  7.87917376e-02
  1.69300679e-02  7.46250665e-03 -2.63887253e-02 -5.91586418e-02
  3.61846052e-02  2.83386894e-02 -4.02504615e-02  3.24034542e-02
  4.81554642e-02  4.19547185e-02 -3.92167456e-03 -3.88981402e-02
 -2.91081388e-02 -3.33773419e-02 -2.34370516e-03  3.76801677e-02
  9.32158157e-03 -4.78495385e-05 -9.22859274e-03 -1.74920820e-02
 -8.93182063e-04 -4.02295999e-02  1.25317480e-02 -5.07667437e-02
  6.57177791e-02  4.40889085e-03 -4.74674776e-02 -4.20759395e-02
 -4.54053544e-02  3.72121520e-02 -6.74653724e-02 -1.26543557e-02
  5.30722402e-02  1.19144712e-02 -4.75504734e-02  2.07491994e-01
 -3.15199718e-02 -1.79592799e-02  1.74302943e-02  4.15849611e-02
  1.63145103e-02 -4.53018863e-03  1.10204173e-02 -7.70706311e-03
 -3.90308499e-02  2.29247957e-02 -8.95982236e-03 -4.44980748e-02
  5.87830991e-02 -2.49170121e-02  2.13459264e-02 -7.01097073e-03
 -1.99152343e-02  7.43537396e-03 -1.62108094e-02  2.50770375e-02
 -4.84852586e-03 -6.43334002e-04 -5.39370114e-03  4.15919581e-03
 -6.61914190e-03 -2.94017196e-02  3.69912200e-02  1.04126759e-01
 -1.83426831e-02  5.85851483e-02  3.41925360e-02 -1.30385300e-02
 -4.31444459e-02  1.94726195e-02 -2.46880017e-02  5.94871491e-02
  6.01246990e-02  2.20576469e-02  2.09064689e-02 -2.95787975e-02
 -3.74507345e-02 -9.91411135e-02 -1.62311792e-02 -9.36319381e-02
  2.95112208e-02  1.09276846e-01 -4.60000895e-02  1.03560530e-01
 -5.42839505e-02 -4.15560268e-02 -7.18593597e-03  2.45037954e-02
 -4.80614975e-02 -1.45595986e-02  2.12463941e-02  3.24782170e-02
  4.07646783e-03  7.94193968e-02 -2.19647363e-02  4.10122573e-02
 -1.52564310e-02 -9.02258828e-02 -5.33621088e-02  8.33914205e-02
  3.69868949e-02 -7.77851939e-02 -2.47363057e-02 -4.13753167e-02
 -2.59114429e-03  9.47038084e-03 -4.55202349e-03  1.71372537e-02
 -3.67161334e-02  1.09517400e-03  4.43165675e-02  2.98536066e-02
 -6.25513420e-02 -3.18379663e-02  2.58475654e-02  2.65176278e-02
  6.02048486e-02 -1.28807751e-02 -4.75639151e-03  7.46422401e-03
 -1.08148693e-03 -6.61053061e-02  5.28771384e-03 -3.34371403e-02
  7.56227784e-03  7.49716386e-02 -2.72583626e-02  4.19106111e-02
 -5.92651367e-02 -3.63178216e-02 -7.34194997e-04 -4.95213903e-02
 -3.02970018e-02 -4.75113429e-02 -2.31888704e-02 -3.92498150e-02
  7.87384957e-02  4.73796092e-02 -3.69955115e-02  8.89999978e-03
 -1.41175641e-02  3.70591171e-02 -2.13845745e-02 -3.88728976e-02
  4.11152840e-02  3.39885205e-02 -7.54489228e-02 -4.23302874e-02
  5.03290780e-02 -1.41736888e-03 -1.57192126e-02 -6.81487785e-04
  2.62937788e-02  1.65717956e-02  2.96040177e-02  3.75823453e-02
  3.85949351e-02 -5.25422804e-02 -6.68504685e-02 -2.40721717e-01
  5.31001277e-02  4.88259457e-02  7.52564566e-03  6.00114614e-02
 -5.75215220e-02  5.37195206e-02 -1.64394546e-03  1.66885965e-02
  6.79540560e-02  9.67501253e-02 -9.14059859e-03  4.90858816e-02
 -2.45258696e-02 -1.41069936e-02  2.22682506e-02 -1.61982439e-02
  2.55039409e-02 -5.50560700e-03 -2.16496829e-02  9.24327690e-03
  2.61107646e-02  2.21175086e-02 -5.33901602e-02  6.47620261e-02
 -2.41723973e-02  2.09231824e-01  4.94239712e-03  9.78675764e-03
 -1.14319110e-02  5.38960285e-02  5.23228571e-02 -4.77401912e-02
 -1.15589313e-01  4.18888889e-02  4.74669151e-02  1.42316613e-02
  4.59595025e-02 -1.16531989e-02 -1.35775795e-02 -8.62559397e-03
  5.78900315e-02  1.76895726e-02 -9.85420719e-02  1.14755193e-02
 -2.59594154e-02 -5.50190806e-02  4.63129021e-02 -2.16614865e-02
  1.19846957e-02  4.64428104e-02 -2.35914774e-02  2.31499076e-02
  2.87752468e-02  1.55654578e-02 -2.76088510e-02 -4.96429689e-02
  1.57907102e-02 -2.37696357e-02  2.10290924e-02 -9.56129748e-03
 -6.75709099e-02 -1.08783762e-03 -5.85781671e-02  5.43339401e-02
 -8.01713392e-03 -3.95058235e-03 -3.73170264e-02  3.36818807e-02
 -1.78178847e-02 -5.18017123e-03  9.07832980e-02  8.56774021e-03
 -1.12804892e-02  5.91469593e-02  2.62278840e-02  1.66546777e-02
  4.76784483e-02  3.76462541e-03 -3.64912562e-02  8.26206338e-03
 -3.34407613e-02  5.43547459e-02  8.09137672e-02  2.10414696e-02
 -3.01878480e-03  3.15363668e-02 -3.27343419e-02  7.01470748e-02
 -1.77230500e-02 -3.05388123e-02  2.11388152e-02 -2.30868142e-02
  2.83382069e-02 -1.66708604e-02 -7.34722568e-03 -3.13336521e-01
  2.51765084e-02  4.47531231e-03  3.88647206e-02 -6.53676130e-03
  6.29957244e-02  5.01673706e-02  3.95408385e-02 -7.03862011e-02
 -1.21406484e-02 -7.68086612e-02  2.41932981e-02  6.49805069e-02
  3.32606696e-02  1.99224241e-02  1.77097246e-02  3.70892733e-02
 -7.13423640e-02  4.19507474e-02 -5.10222688e-02 -3.37072313e-02
  1.94280408e-02  2.02786013e-01 -5.27696274e-02  1.87298767e-02
 -7.28620961e-03  1.92789830e-05 -1.96223632e-02  5.84295616e-02
  2.03254111e-02  1.20151397e-02  1.48937041e-02  8.26504230e-02
 -2.68591400e-02  9.70662832e-02  5.85142225e-02 -8.25221092e-02
  4.92065325e-02  4.62264009e-02 -2.35428214e-02 -3.92516367e-02
 -9.13508981e-03 -2.51793899e-02 -2.06447467e-02  3.43762711e-02
 -5.15712537e-02 -4.10273904e-03 -4.07801419e-02  1.26913590e-02
 -1.13638211e-02 -2.04684865e-02  1.11512681e-02 -3.65107246e-02
 -2.30784286e-02  3.63528468e-02  3.44146825e-02 -5.23219742e-02
 -2.04007477e-02 -4.18296382e-02 -4.20534313e-02  3.72867286e-02
 -8.72437954e-02 -4.99846367e-03  6.71854569e-03  1.20153977e-02]",53
15600,13,1303.0,"```

Then we load the [v1-5 checkpoint](https://huggingface.co/runwayml/stable-diffusion-v1-5) to generate images:

```python
model_ckpt_1_5 = ""runwayml/stable-diffusion-v1-5""
sd_pipeline_1_5 = StableDiffusionPipeline.from_pretrained(model_ckpt_1_5, torch_dtype=weight_dtype).to(device)

images_1_5 = sd_pipeline_1_5(prompts, num_images_per_prompt=1, generator=generator, output_type=""np"").images
```

And finally, we compare their CLIP scores:

```python
sd_clip_score_1_4 = calculate_clip_score(images, prompts)
print(f""CLIP Score with v-1-4: {sd_clip_score_1_4}"")
# CLIP Score with v-1-4: 34.9102

sd_clip_score_1_5 = calculate_clip_score(images_1_5, prompts)
print(f""CLIP Score with v-1-5: {sd_clip_score_1_5}"")
# CLIP Score with v-1-5: 36.2137","[-6.98911101e-02 -4.41925600e-02  1.11318715e-02 -3.87295149e-02
  3.27152573e-02  3.61277796e-02  6.92618219e-03  7.29079824e-04
  1.26613798e-02 -3.87736899e-03 -6.42849086e-03 -1.06108427e-01
  7.26639554e-02  2.32680310e-02 -6.23343438e-02  5.89388423e-03
  3.43891472e-04 -1.39948810e-02 -2.04884540e-02 -1.67803168e-02
  1.35790193e-02 -1.81001183e-02 -1.41417782e-03 -8.51296112e-02
  4.53712158e-02  2.96270214e-02 -1.64354723e-02 -1.78963859e-02
 -1.54431267e-02 -2.56320328e-01  3.40932198e-02 -6.48908019e-02
  6.26509339e-02 -2.99762804e-02 -8.74515250e-03 -1.88555755e-02
 -2.17629801e-02  2.92089917e-02 -2.27118321e-02  5.38923740e-02
  1.51299154e-02 -5.90694183e-03 -3.92907150e-02 -4.94644418e-02
 -2.02916693e-02 -5.51560186e-02 -3.20446864e-02 -3.92899886e-02
  5.44849671e-02 -1.41807692e-02  2.34460086e-02 -4.80340123e-02
 -1.75686944e-02  8.11656192e-03 -2.11425014e-02  1.79777108e-02
  5.13168275e-02  5.76397106e-02  4.73336391e-02 -1.50995341e-03
  1.07300412e-02  1.34818498e-02 -2.07422405e-01  6.22842386e-02
  2.54697539e-02  2.11515538e-02 -6.03604876e-02 -3.29525881e-02
 -2.08458910e-03  7.85592869e-02 -5.79395816e-02  3.29897515e-02
  2.92024538e-02  3.25472057e-02  1.72948523e-03 -4.39778827e-02
  9.83146485e-03 -4.06262800e-02 -3.59737091e-02  3.58416811e-02
 -2.16458105e-02 -2.65977811e-02 -3.92187834e-02 -1.69112757e-02
 -1.60819246e-03  2.27886741e-03  1.12864403e-02 -3.63060758e-02
  5.90399094e-02  1.36482250e-02 -6.02873452e-02 -1.34994164e-02
 -5.18367179e-02  8.21077228e-02 -5.89936525e-02 -3.02221421e-02
  4.44836058e-02 -2.41267048e-02  6.61350973e-03  2.11396903e-01
 -6.22621886e-02  3.74298729e-02  2.06797328e-02  2.08405554e-02
  2.39524841e-02 -1.81323495e-02 -2.41116658e-02 -4.83926199e-02
 -3.56744342e-02 -1.99863594e-02  2.63001863e-02 -1.89353395e-02
  5.44156097e-02 -2.66962145e-02  8.26450437e-03 -3.19015031e-04
  1.88817866e-02  1.76030975e-02 -2.21784171e-02  1.09185148e-02
 -3.04828715e-02  2.27099564e-02  3.72677259e-02 -5.55136725e-02
  1.55288298e-02 -1.68491935e-03  5.08834012e-02  1.08027361e-01
  1.72776226e-02  3.37764695e-02  3.74330878e-02 -3.15160155e-02
 -8.09772760e-02 -1.51309380e-02 -3.11755594e-02  1.10848602e-02
  3.27716582e-02 -8.35921429e-03  1.17518753e-02 -4.88490649e-02
  2.28281729e-02 -7.48546347e-02  1.53353624e-02 -6.55279905e-02
 -3.13546248e-02  1.59042150e-01 -3.19008939e-02  8.22743103e-02
 -4.50491272e-02 -5.02225459e-02 -1.00752590e-02  3.45318671e-03
 -1.69582665e-02 -2.42901631e-02  2.64611766e-02  4.40787189e-02
  1.07457880e-02  7.95565546e-02 -4.66786772e-02  4.94921543e-02
  2.50582141e-03 -6.29411414e-02 -6.79707751e-02  9.79427248e-02
  3.73269208e-02 -6.17455095e-02 -1.14275366e-02  7.07199855e-04
  2.73771817e-04 -4.27112505e-02  2.13135257e-02 -2.12066970e-03
 -7.35921338e-02 -1.66859217e-02  2.77873557e-02  7.46040605e-03
 -8.66904631e-02 -8.53843987e-04  3.55641358e-02  9.64219309e-03
  8.32476094e-03 -6.88033700e-02 -3.66370678e-02 -6.52820757e-03
 -1.52842060e-03 -5.95773123e-02 -3.80230993e-02 -9.09643248e-02
  2.99566630e-02  7.16589764e-02  5.65359183e-03 -4.17141337e-03
 -9.24272463e-03 -1.90704614e-02 -6.39982661e-03 -4.23472449e-02
 -3.78917083e-02 -1.03149880e-02 -9.32767149e-03 -5.12528419e-02
  2.07361989e-02  2.59783138e-02  1.58813559e-02  2.01746672e-02
 -2.93475799e-02  9.51567013e-03 -4.33867648e-02 -4.00764756e-02
  5.57817891e-02  5.73367551e-02 -4.37389724e-02 -3.38537395e-02
  5.45413718e-02  3.00466781e-03 -3.20359729e-02 -3.81947728e-03
  1.74295949e-03  2.43919063e-02  1.44023960e-02  6.35810494e-02
  2.72046234e-02 -2.20142417e-02 -2.40206979e-02 -2.64170527e-01
  3.26359272e-02  2.96125598e-02  1.71422642e-02  6.58511519e-02
 -4.36439440e-02  4.92364429e-02  1.12285408e-04  8.61522369e-03
  4.39976677e-02  9.49931741e-02 -4.38599475e-02  4.64925319e-02
  1.73207894e-02 -4.00923286e-03  1.34400045e-02 -1.34753203e-02
  2.99828481e-02 -2.51191650e-02 -2.06190385e-02 -8.86578020e-03
 -2.26517376e-02 -3.09338663e-02 -7.84633681e-02  6.29778802e-02
 -5.87139577e-02  2.39359275e-01  2.79600732e-02  3.78143713e-02
  3.03431153e-02  3.55382301e-02  3.63182761e-02 -4.29406241e-02
 -7.36288726e-02  2.16094088e-02  4.03032824e-02  4.76474203e-02
 -3.58663197e-03  4.27608658e-03 -9.70824994e-03 -2.93057021e-02
  4.42397147e-02  1.79117229e-02 -7.61343464e-02 -2.09368803e-02
 -2.89406423e-02 -4.47071232e-02  4.93592247e-02 -2.36013215e-02
  1.34050259e-02  2.41104662e-02 -3.41526531e-02  9.53742303e-03
  1.85574742e-03  1.93650257e-02 -3.15358378e-02 -6.98574707e-02
  3.25707756e-02 -3.37366834e-02  2.93382928e-02 -3.65179824e-03
 -8.09206963e-02  1.74248591e-02 -3.47047225e-02  4.98147309e-02
 -9.99483094e-03  2.49460922e-03 -4.94684726e-02  4.54381146e-02
 -1.73794422e-02  4.50680777e-03  1.06716588e-01 -6.67548599e-03
  3.65679264e-02  6.44953325e-02  2.41074674e-02  3.41095217e-03
  5.26922056e-03 -1.23646939e-02 -1.18498066e-02  4.37596701e-02
 -2.52948282e-03  3.18238102e-02  3.59120890e-02  4.11880910e-02
  1.13308672e-02  7.04824179e-02  3.51994783e-02  8.01718011e-02
 -2.43932698e-02 -2.07577739e-03  1.49437422e-02 -4.94274274e-02
 -1.37664238e-02  1.18948882e-02  2.08148882e-02 -2.83847094e-01
  4.14539389e-02  7.27022951e-03  3.26803699e-02  3.17817628e-02
  3.47722992e-02  7.52776638e-02  1.72463916e-02 -4.98761199e-02
 -1.57536194e-02 -4.68836240e-02  3.57517973e-02  3.57312001e-02
  1.04027456e-02  1.53351855e-02  5.38110957e-02  6.14110716e-02
 -5.41905425e-02  4.80012447e-02 -3.68275084e-02 -1.96591336e-02
  2.55093221e-02  1.79857865e-01 -6.35798201e-02 -2.35085394e-02
  1.55654885e-02 -1.09295584e-02  1.89743564e-03  6.29716292e-02
  7.36505352e-03  1.65616944e-02  3.56804542e-02  6.99777007e-02
 -2.57282145e-02  4.95284460e-02  9.26429108e-02 -4.90592383e-02
  3.83750536e-02  4.06624563e-02 -4.10678126e-02  9.84994415e-03
 -8.54218670e-04 -1.26208272e-02 -1.63943004e-02  9.79377404e-02
 -3.91678736e-02  2.13087853e-02 -4.78179790e-02  1.44131563e-03
 -5.83061995e-03 -3.63161974e-02  1.44077307e-02 -8.50540772e-03
 -1.15770940e-02  6.12679385e-02  6.60314038e-02 -2.22766288e-02
  1.74940173e-02 -6.44757971e-02 -1.02687124e-02  2.95884944e-02
 -4.97399569e-02  2.86952909e-02  4.40427251e-02 -1.49421475e-03]",53
17256,5,1457.0,"```
For each image generation the active concept is also contained in [`StableDiffusionSafePipelineOutput`].

There are 4 configurations (`SafetyConfig.WEAK`, `SafetyConfig.MEDIUM`, `SafetyConfig.STRONG`, and `SafetyConfig.MAX`) that can be applied:

```python
>>> from diffusers import StableDiffusionPipelineSafe
>>> from diffusers.pipelines.stable_diffusion_safe import SafetyConfig

>>> pipeline = StableDiffusionPipelineSafe.from_pretrained(""AIML-TUDA/stable-diffusion-safe"")
>>> prompt = ""the four horsewomen of the apocalypse, painting by tom of finland, gaston bussiere, craig mullins, j. c. leyendecker""
>>> out = pipeline(prompt=prompt, **SafetyConfig.MAX)","[-4.81471755e-02 -2.37253495e-02  1.80120710e-02 -1.70130213e-03
  1.05575472e-02  2.66812481e-02  1.31700113e-02 -1.19633565e-03
 -1.62269697e-02  3.69077064e-02 -2.95034107e-02 -9.62630734e-02
  6.96406364e-02 -6.60825334e-03 -3.93183343e-02  1.59850977e-02
 -8.31557030e-04  4.80902605e-02 -3.80007215e-02  6.03273557e-03
  3.88005637e-02  3.18885855e-02  1.34077910e-02 -8.54047090e-02
  5.91985974e-03  1.97264478e-02 -1.23146200e-03 -1.76017713e-02
 -2.16279794e-02 -1.87615052e-01 -1.99194178e-02 -6.22622259e-02
  3.87538038e-02 -2.93728653e-02 -1.78333744e-02 -5.72126964e-03
 -5.11794314e-02  5.44790104e-02 -3.79784219e-02  3.69476490e-02
  7.40694022e-03  4.48180502e-03 -2.69140080e-02 -4.13451418e-02
 -3.51431780e-02 -4.82222103e-02 -4.68909256e-02 -4.65760790e-02
  1.83634739e-02 -1.29996864e-02  3.02629583e-02 -6.59761950e-02
  4.75485250e-03  2.15982907e-02  1.48185203e-02 -2.03906819e-02
  4.30274792e-02  5.18478127e-03  1.81658790e-02  3.11558880e-02
  5.42466342e-02  6.32498041e-02 -1.99004889e-01  6.57193884e-02
  1.63051244e-02  3.78824398e-02 -5.70271313e-02 -4.07569967e-02
  3.09122466e-02  6.25729635e-02 -5.39900102e-02  3.31772715e-02
  2.93769576e-02  3.53489295e-02  1.45853842e-02 -2.17924435e-02
  9.91037022e-03 -2.96977591e-02 -3.18607353e-02  2.98548397e-03
  1.32116154e-02 -2.32477672e-02 -1.07322028e-02  5.10986242e-03
 -2.40433067e-02  6.20085560e-03  1.82617754e-02 -8.03263858e-02
  3.48792933e-02  1.66944321e-02 -9.33032781e-02 -1.43882548e-02
  4.76652430e-03  5.08889891e-02 -3.90465707e-02 -1.25196651e-02
  4.96334471e-02 -1.56960404e-03 -2.51623522e-03  1.96013853e-01
 -5.45580909e-02  2.99311522e-03  2.62182504e-02  4.00657132e-02
  1.55471340e-02 -7.47382548e-03 -4.25617024e-02 -1.84636582e-02
 -4.30168547e-02 -4.21430506e-02 -5.96749270e-03 -5.39339259e-02
  2.76721790e-02 -3.76332365e-02  2.14207135e-02  1.13920389e-04
 -1.28315240e-02  5.05303149e-04 -2.29272973e-02  1.91211086e-02
  1.99626870e-02  1.72470436e-02  5.31434827e-02 -4.99405339e-03
  9.85672884e-03 -3.58933434e-02  8.83312076e-02  1.03613593e-01
  3.43443528e-02  3.99437286e-02  4.52075563e-02 -5.07506449e-03
 -1.14189014e-02  1.67092755e-02  1.75488472e-04  1.67183783e-02
  3.30468547e-03  9.94529948e-03  1.91130061e-02  1.10227196e-03
 -1.32789779e-02 -6.00912385e-02 -1.81740262e-02 -1.09243222e-01
  1.98455658e-02  1.26346394e-01 -3.57224941e-02  9.26321745e-02
 -7.23516475e-03  1.21186615e-03 -2.73399185e-02 -4.93691908e-03
 -1.84043348e-02 -5.15015842e-03  2.02283710e-02  5.76631837e-02
  2.46431753e-02  8.69987011e-02 -2.88035236e-02  3.85502689e-02
 -5.52205276e-03 -9.56453308e-02 -6.24473281e-02  1.34390384e-01
 -2.45401748e-02 -4.84641902e-02 -2.60850391e-03 -1.19740460e-02
 -2.17808271e-03 -4.01257761e-02  6.08925149e-03 -1.31948302e-02
 -7.81991519e-03 -4.84938826e-03  1.95473712e-02  2.79081538e-02
 -7.69865438e-02 -2.99857985e-02  2.69876514e-02  3.15271690e-02
  5.59555590e-02 -5.52835502e-02 -3.80986370e-02  6.60468033e-03
  1.31307282e-02 -6.81221634e-02 -3.36320177e-02 -6.64153546e-02
  3.66801582e-02  8.29899684e-02 -1.40908295e-02  1.59116425e-02
 -2.70479266e-02 -5.21929078e-02 -2.47893911e-02 -1.35790696e-02
 -2.13373429e-03 -3.18640359e-02 -1.71370115e-02 -9.01429169e-03
  2.53055356e-02  1.33870803e-02 -1.19428458e-02  2.00245231e-02
 -3.97479311e-02  2.20852941e-02 -2.87142619e-02 -6.75560394e-03
  5.28166108e-02  3.17249224e-02 -6.55652136e-02  1.02181165e-02
  5.93164302e-02 -2.13495549e-02 -6.02761135e-02  6.30514743e-03
 -1.51865482e-02  2.51402501e-02  3.09367571e-02  4.69491147e-02
  7.41713569e-02 -3.18446122e-02 -7.27715790e-02 -3.06307703e-01
  2.53733806e-02  3.45814116e-02 -1.90427806e-02  7.23530278e-02
 -5.08338474e-02  2.89192982e-02 -3.18935998e-02 -2.68481881e-03
  6.84661493e-02  1.01989664e-01 -3.18948552e-02  1.27388984e-02
  2.54015136e-03 -2.05943491e-02  4.49432917e-02 -5.17234914e-02
 -2.04716111e-03 -1.56068290e-02  3.22239520e-03 -6.65809633e-03
  2.39912514e-03 -2.16324795e-02 -1.12084396e-01  3.80269215e-02
 -1.62590332e-02  2.40743443e-01  2.43049301e-02  3.22317928e-02
 -9.04405490e-03  4.24173810e-02  8.00781138e-03 -4.34907749e-02
 -9.93948504e-02  2.88197231e-02  3.81322429e-02  2.68029664e-02
 -4.59458353e-03  3.01638562e-02 -9.96692013e-03  3.68290959e-04
  6.21243380e-02 -1.37769934e-02 -7.49774948e-02 -7.18536321e-03
 -2.51946151e-02 -3.57581228e-02  8.05290788e-02 -4.07439619e-02
 -2.28359690e-03  4.82300110e-02 -2.31072120e-02  1.09011093e-02
  1.94570944e-02 -1.25064859e-02 -4.17145863e-02 -4.38271798e-02
  2.57571097e-02 -4.07783948e-02  3.40010151e-02 -4.60566394e-03
 -2.35196613e-02  1.64221283e-02 -1.11846328e-02  4.78219315e-02
 -3.65731604e-02 -1.53961638e-02 -8.10177252e-02  4.60733436e-02
 -3.25715877e-02 -2.12867483e-02  1.17833316e-01  1.15241585e-02
  2.52115242e-02  6.79943636e-02  3.34570222e-02 -7.07700197e-03
  9.38776415e-03 -2.13445369e-02 -1.63891800e-02  4.36994582e-02
 -3.27916518e-02  2.17031445e-02  3.49761993e-02  2.39888057e-02
  3.68310255e-03  2.47677732e-02 -1.62900705e-02  7.19721988e-02
  6.18494488e-03 -7.16031203e-03  2.79522128e-02 -3.58409546e-02
  4.63297106e-02  1.95473675e-02 -2.66099581e-03 -3.06651145e-01
  3.37581187e-02  5.14031667e-03  3.45855020e-02 -2.77456138e-02
  1.92183610e-02  7.67798275e-02  5.00275232e-02 -5.75946458e-02
 -1.94719192e-02 -7.24746883e-02  4.36358750e-02  5.00556044e-02
  2.47026253e-02 -6.53408328e-03  5.06274663e-02  4.76190075e-02
 -6.41701892e-02  2.49859206e-02 -7.33252764e-02 -1.72743096e-03
  4.62838076e-02  2.10063159e-01 -5.81988059e-02  4.53412719e-03
  2.48279199e-02  1.68788969e-03  1.19726537e-02  9.53408889e-03
 -3.69240739e-03  5.36573902e-02  1.06764361e-02  4.63883244e-02
 -6.21435195e-02  3.16776894e-02  4.03632633e-02 -2.81263348e-02
  3.76175493e-02  2.91365851e-02 -4.52991836e-02 -4.93084155e-02
  2.88695693e-02 -1.68842990e-02 -4.53701057e-02  6.18363991e-02
 -4.10171710e-02  7.93989189e-03 -5.50287254e-02 -1.07226968e-02
  1.75524373e-02 -2.32150480e-02 -2.12754440e-02 -1.60303677e-03
 -8.28970037e-03  6.59272596e-02  5.57451583e-02 -5.55724697e-03
  1.46293566e-02 -1.97485555e-02  1.66494318e-03  4.14996147e-02
 -6.49235770e-02 -4.07063839e-04  5.06544299e-02  1.16181783e-02]",53
